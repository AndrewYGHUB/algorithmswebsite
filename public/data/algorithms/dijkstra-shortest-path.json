{
  "slug": "dijkstra-shortest-path",
  "name": "Dijkstra Shortest Path",
  "categories": [
    "graphs"
  ],
  "body": {},
  "implementations": {
    "c-sharp": {
      "dir": "./Algorithms/Graph/Dijkstra/DijkstraAlgorithm.cs",
      "url": "https:/github.com/TheAlgorithms/C-Sharp/tree/master/Algorithms/Graph/Dijkstra/DijkstraAlgorithm.cs",
      "code": "ï»¿<span class=\"hljs-keyword\">using</span> System;\n<span class=\"hljs-keyword\">using</span> System.Collections.Generic;\n<span class=\"hljs-keyword\">using</span> System.Linq;\n<span class=\"hljs-keyword\">using</span> DataStructures.Graph;\n\n<span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title\">Algorithms.Graph.Dijkstra</span>\n{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DijkstraAlgorithm</span>\n    {\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;summary&gt;</span></span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> Implementation of the Dijkstra shortest path algorithm for cyclic graphs.</span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm.</span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;/summary&gt;</span></span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;param name=&quot;graph&quot;&gt;</span>Graph instance.<span class=\"hljs-doctag\">&lt;/param&gt;</span></span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;param name=&quot;startVertex&quot;&gt;</span>Starting vertex instance.<span class=\"hljs-doctag\">&lt;/param&gt;</span></span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;typeparam name=&quot;T&quot;&gt;</span>Generic Parameter.<span class=\"hljs-doctag\">&lt;/typeparam&gt;</span></span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;returns&gt;</span>List of distances from current vertex to all other vertices.<span class=\"hljs-doctag\">&lt;/returns&gt;</span></span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&lt;exception cref=&quot;InvalidOperationException&quot;&gt;</span>Exception thrown in case when graph is null or start</span>\n        <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> vertex does not belong to graph instance.<span class=\"hljs-doctag\">&lt;/exception&gt;</span></span>\n        <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-title\">DistanceModel</span>&lt;<span class=\"hljs-title\">T</span>&gt;[] <span class=\"hljs-title\">GenerateShortestPath</span>&lt;<span class=\"hljs-title\">T</span>&gt;(<span class=\"hljs-params\">DirectedWeightedGraph&lt;T&gt; graph, Vertex&lt;T&gt; startVertex</span>)</span>\n        {\n            ValidateGraphAndStartVertex(graph, startVertex);\n\n            <span class=\"hljs-keyword\">var</span> visitedVertices = <span class=\"hljs-keyword\">new</span> List&lt;Vertex&lt;T&gt;&gt;();\n\n            <span class=\"hljs-keyword\">var</span> distanceArray = InitializeDistanceArray(graph, startVertex);\n\n            <span class=\"hljs-keyword\">var</span> currentVertex = startVertex;\n\n            <span class=\"hljs-keyword\">var</span> currentPath = <span class=\"hljs-number\">0</span>d;\n\n            <span class=\"hljs-keyword\">while</span> (<span class=\"hljs-literal\">true</span>)\n            {\n                visitedVertices.Add(currentVertex);\n\n                <span class=\"hljs-keyword\">var</span> neighborVertices = graph\n                    .GetNeighbors(currentVertex)\n                    .Where(x =&gt; x != <span class=\"hljs-literal\">null</span> &amp;&amp; !visitedVertices.Contains(x))\n                    .ToList();\n\n                <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-keyword\">var</span> vertex <span class=\"hljs-keyword\">in</span> neighborVertices)\n                {\n                    <span class=\"hljs-keyword\">var</span> adjacentDistance = graph.AdjacentDistance(currentVertex, vertex!);\n\n                    <span class=\"hljs-keyword\">var</span> distance = distanceArray[vertex!.Index];\n\n                    <span class=\"hljs-keyword\">if</span> (distance.Distance &lt;= currentPath + adjacentDistance)\n                    {\n                        <span class=\"hljs-keyword\">continue</span>;\n                    }\n\n                    distance.Distance = currentPath + adjacentDistance;\n                    distance.PreviousVertex = currentVertex;\n                }\n\n                <span class=\"hljs-keyword\">var</span> minimalAdjacentVertex = GetMinimalUnvisitedAdjacentVertex(graph, currentVertex, neighborVertices);\n\n                <span class=\"hljs-keyword\">if</span> (neighborVertices.Count == <span class=\"hljs-number\">0</span> || minimalAdjacentVertex <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">null</span>)\n                {\n                    <span class=\"hljs-keyword\">break</span>;\n                }\n\n                currentPath += graph.AdjacentDistance(currentVertex, minimalAdjacentVertex);\n\n                currentVertex = minimalAdjacentVertex;\n            }\n\n            <span class=\"hljs-keyword\">return</span> distanceArray;\n        }\n\n        <span class=\"hljs-function\"><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-title\">DistanceModel</span>&lt;<span class=\"hljs-title\">T</span>&gt;[] <span class=\"hljs-title\">InitializeDistanceArray</span>&lt;<span class=\"hljs-title\">T</span>&gt;(<span class=\"hljs-params\">\n            IDirectedWeightedGraph&lt;T&gt; graph,\n            Vertex&lt;T&gt; startVertex</span>)</span>\n        {\n            <span class=\"hljs-keyword\">var</span> distArray = <span class=\"hljs-keyword\">new</span> DistanceModel&lt;T&gt;[graph.Count];\n\n            distArray[startVertex.Index] = <span class=\"hljs-keyword\">new</span> DistanceModel&lt;T&gt;(startVertex, startVertex, <span class=\"hljs-number\">0</span>);\n\n            <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-keyword\">var</span> vertex <span class=\"hljs-keyword\">in</span> graph.Vertices.Where(x =&gt; x != <span class=\"hljs-literal\">null</span> &amp;&amp; !x.Equals(startVertex)))\n            {\n                distArray[vertex!.Index] = <span class=\"hljs-keyword\">new</span> DistanceModel&lt;T&gt;(vertex, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-built_in\">double</span>.MaxValue);\n            }\n\n            <span class=\"hljs-keyword\">return</span> distArray;\n        }\n\n        <span class=\"hljs-function\"><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">ValidateGraphAndStartVertex</span>&lt;<span class=\"hljs-title\">T</span>&gt;(<span class=\"hljs-params\">DirectedWeightedGraph&lt;T&gt; graph, Vertex&lt;T&gt; startVertex</span>)</span>\n        {\n            <span class=\"hljs-keyword\">if</span> (graph <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">null</span>)\n            {\n                <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> ArgumentNullException(<span class=\"hljs-keyword\">nameof</span>(graph));\n            }\n\n            <span class=\"hljs-keyword\">if</span> (startVertex.Graph != <span class=\"hljs-literal\">null</span> &amp;&amp; !startVertex.Graph.Equals(graph))\n            {\n                <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> ArgumentNullException(<span class=\"hljs-keyword\">nameof</span>(graph));\n            }\n        }\n\n        <span class=\"hljs-function\"><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-title\">Vertex</span>&lt;<span class=\"hljs-title\">T</span>&gt;? <span class=\"hljs-title\">GetMinimalUnvisitedAdjacentVertex</span>&lt;<span class=\"hljs-title\">T</span>&gt;(<span class=\"hljs-params\">\n            IDirectedWeightedGraph&lt;T&gt; graph,\n            Vertex&lt;T&gt; startVertex,\n            IEnumerable&lt;Vertex&lt;T&gt;?&gt; adjacentVertices</span>)</span>\n        {\n            <span class=\"hljs-keyword\">var</span> minDistance = <span class=\"hljs-built_in\">double</span>.MaxValue;\n            Vertex&lt;T&gt;? minVertex = <span class=\"hljs-literal\">default</span>;\n\n            <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-keyword\">var</span> vertex <span class=\"hljs-keyword\">in</span> adjacentVertices)\n            {\n                <span class=\"hljs-keyword\">var</span> currentDistance = graph.AdjacentDistance(startVertex, vertex!);\n\n                <span class=\"hljs-keyword\">if</span> (minDistance &lt;= currentDistance)\n                {\n                    <span class=\"hljs-keyword\">continue</span>;\n                }\n\n                minDistance = currentDistance;\n                minVertex = vertex;\n            }\n\n            <span class=\"hljs-keyword\">return</span> minVertex;\n        }\n    }\n}\n"
    }
  },
  "contributors": [],
  "explanationUrl": {}
}