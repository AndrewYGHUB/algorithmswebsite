{
  "slug": "gabor-filter",
  "name": "Gabor Filter",
  "categories": [
    "digitalimageprocessing",
    "filters"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "digital_image_processing/filters/gabor_filter.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/digital_image_processing/filters/gabor_filter.py",
      "code": "<span class=\"hljs-comment\"># Implementation of the Gaborfilter</span>\n<span class=\"hljs-comment\"># https://en.wikipedia.org/wiki/Gabor_filter</span>\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> cv2 <span class=\"hljs-keyword\">import</span> COLOR_BGR2GRAY, CV_8UC3, cvtColor, filter2D, imread, imshow, waitKey\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">gabor_filter_kernel</span>(<span class=\"hljs-params\">\n    ksize: <span class=\"hljs-built_in\">int</span>, sigma: <span class=\"hljs-built_in\">int</span>, theta: <span class=\"hljs-built_in\">int</span>, lambd: <span class=\"hljs-built_in\">int</span>, gamma: <span class=\"hljs-built_in\">int</span>, psi: <span class=\"hljs-built_in\">int</span>\n</span>) -&gt; np.ndarray:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    :param ksize:   The kernelsize of the convolutional filter (ksize x ksize)\n    :param sigma:   standard deviation of the gaussian bell curve\n    :param theta:   The orientation of the normal to the parallel stripes\n                    of Gabor function.\n    :param lambd:   Wavelength of the sinusoidal component.\n    :param gamma:   The spatial aspect ratio and specifies the ellipticity\n                    of the support of Gabor function.\n    :param psi:     The phase offset of the sinusoidal function.\n\n    &gt;&gt;&gt; gabor_filter_kernel(3, 8, 0, 10, 0, 0).tolist()\n    [[0.8027212023735046, 1.0, 0.8027212023735046], [0.8027212023735046, 1.0, \\\n0.8027212023735046], [0.8027212023735046, 1.0, 0.8027212023735046]]\n\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-comment\"># prepare kernel</span>\n    <span class=\"hljs-comment\"># the kernel size have to be odd</span>\n    <span class=\"hljs-keyword\">if</span> (ksize % <span class=\"hljs-number\">2</span>) == <span class=\"hljs-number\">0</span>:\n        ksize = ksize + <span class=\"hljs-number\">1</span>\n    gabor = np.zeros((ksize, ksize), dtype=np.float32)\n\n    <span class=\"hljs-comment\"># each value</span>\n    <span class=\"hljs-keyword\">for</span> y <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(ksize):\n        <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(ksize):\n            <span class=\"hljs-comment\"># distance from center</span>\n            px = x - ksize // <span class=\"hljs-number\">2</span>\n            py = y - ksize // <span class=\"hljs-number\">2</span>\n\n            <span class=\"hljs-comment\"># degree to radiant</span>\n            _theta = theta / <span class=\"hljs-number\">180</span> * np.pi\n            cos_theta = np.cos(_theta)\n            sin_theta = np.sin(_theta)\n\n            <span class=\"hljs-comment\"># get kernel x</span>\n            _x = cos_theta * px + sin_theta * py\n\n            <span class=\"hljs-comment\"># get kernel y</span>\n            _y = -sin_theta * px + cos_theta * py\n\n            <span class=\"hljs-comment\"># fill kernel</span>\n            gabor[y, x] = np.exp(\n                -(_x**<span class=\"hljs-number\">2</span> + gamma**<span class=\"hljs-number\">2</span> * _y**<span class=\"hljs-number\">2</span>) / (<span class=\"hljs-number\">2</span> * sigma**<span class=\"hljs-number\">2</span>)\n            ) * np.cos(<span class=\"hljs-number\">2</span> * np.pi * _x / lambd + psi)\n\n    <span class=\"hljs-keyword\">return</span> gabor\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    <span class=\"hljs-keyword\">import</span> doctest\n\n    doctest.testmod()\n    <span class=\"hljs-comment\"># read original image</span>\n    img = imread(<span class=\"hljs-string\">&quot;../image_data/lena.jpg&quot;</span>)\n    <span class=\"hljs-comment\"># turn image in gray scale value</span>\n    gray = cvtColor(img, COLOR_BGR2GRAY)\n\n    <span class=\"hljs-comment\"># Apply multiple Kernel to detect edges</span>\n    out = np.zeros(gray.shape[:<span class=\"hljs-number\">2</span>])\n    <span class=\"hljs-keyword\">for</span> theta <span class=\"hljs-keyword\">in</span> [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">30</span>, <span class=\"hljs-number\">60</span>, <span class=\"hljs-number\">90</span>, <span class=\"hljs-number\">120</span>, <span class=\"hljs-number\">150</span>]:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        ksize = 10\n        sigma = 8\n        lambd = 10\n        gamma = 0\n        psi = 0\n        &quot;&quot;&quot;</span>\n        kernel_10 = gabor_filter_kernel(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">8</span>, theta, <span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>)\n        out += filter2D(gray, CV_8UC3, kernel_10)\n    out = out / out.<span class=\"hljs-built_in\">max</span>() * <span class=\"hljs-number\">255</span>\n    out = out.astype(np.uint8)\n\n    imshow(<span class=\"hljs-string\">&quot;Original&quot;</span>, gray)\n    imshow(<span class=\"hljs-string\">&quot;Gabor filter with 20x20 mask and 6 directions&quot;</span>, out)\n\n    waitKey(<span class=\"hljs-number\">0</span>)\n"
    }
  },
  "contributors": [
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 1
    },
    {
      "name": "Mozartus",
      "email": "32893711+Mozartuss@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}