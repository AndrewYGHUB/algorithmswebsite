{
  "slug": "sequence-labelling-with-a-bi-lstm-in-py-torch",
  "name": "Sequence Labelling with a Bi LSTM in Py Torch",
  "categories": [
    "neuralnetwork"
  ],
  "body": {
    "all": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"named-entity-recognition-with-pytorch\">Named Entity Recognition with PyTorch</h1>\n</div><div class=\"nb-cell nb-markdown-cell\"><p>In this notebook we'll explore how we can use Deep Learning for sequence labelling tasks such as part-of-speech tagging or named entity recognition. We won't focus on getting state-of-the-art accuracy, but rather, implement a first neural network to get the main concepts across.</p>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"data\">Data</h2>\n</div><div class=\"nb-cell nb-markdown-cell\"><p>For our experiments we'll reuse the NER data we've already used for our CRF experiments. The Dutch CoNLL-2002 data has four kinds of named entities (people, locations, organizations and miscellaneous entities) and comes split into a training, development and test set. </p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"1\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> nltk\n\ntrain_sents = <span class=\"hljs-built_in\">list</span>(nltk.corpus.conll2002.iob_sents(<span class=\"hljs-string\">'ned.train'</span>))\ndev_sents = <span class=\"hljs-built_in\">list</span>(nltk.corpus.conll2002.iob_sents(<span class=\"hljs-string\">'ned.testa'</span>))\ntest_sents = <span class=\"hljs-built_in\">list</span>(nltk.corpus.conll2002.iob_sents(<span class=\"hljs-string\">'ned.testb'</span>))\n\ntrain_sents[:<span class=\"hljs-number\">3</span>]</code></pre></div><div class=\"nb-output\" data-prompt-number=\"1\"><pre class=\"nb-text-output\">[[(<span class=\"hljs-symbol\">&amp;#x27;</span>De<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>tekst<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>van<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Prep<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>het<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>arrest<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>is<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>nog<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adv<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>niet<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adv<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>schriftelijk<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adj<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>beschikbaar<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adj<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>maar<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Conj<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>het<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>bericht<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>werd<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>alvast<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adv<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>bekendgemaakt<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>door<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Prep<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>een<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>communicatiebureau<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>dat<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Conj<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>Floralux<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>B-ORG<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>inhuurde<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>.<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Punc<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>)],\n [(<span class=\"hljs-symbol\">&amp;#x27;</span>In<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Prep<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;quot;</span><span class=\"hljs-symbol\">&amp;#x27;</span>81<span class=\"hljs-symbol\">&amp;quot;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Num<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>regulariseert<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>de<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>toenmalige<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adj<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>Vlaamse<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Adj<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>B-MISC<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>regering<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>de<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>toestand<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>met<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Prep<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>een<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>BPA<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>B-MISC<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>dat<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Pron<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>het<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Art<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>bedrijf<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>op<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Prep<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>eigen<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Pron<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>kosten<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>heeft<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>laten<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>opstellen<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>V<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>),\n  (<span class=\"hljs-symbol\">&amp;#x27;</span>.<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>Punc<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>)],\n [(<span class=\"hljs-symbol\">&amp;#x27;</span>publicatie<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>N<span class=\"hljs-symbol\">&amp;#x27;</span>, <span class=\"hljs-symbol\">&amp;#x27;</span>O<span class=\"hljs-symbol\">&amp;#x27;</span>)]]</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Next, we're going to preprocess the data. For this we use the <code>torchtext</code> Python library, which has a number of handy  utilities for preprocessing natural language. We process our data to a Dataset that consists of Examples. Each of these examples has two fields: a text field and a label field. Both contain sequential information (the sequence of tokens, and the sequence of labels). We don't have to tokenize this information anymore, as the CONLL data has already been tokenized for us.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"2\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> torchtext.data <span class=\"hljs-keyword\">import</span> Example\n<span class=\"hljs-keyword\">from</span> torchtext.data <span class=\"hljs-keyword\">import</span> Field, Dataset\n\ntext_field = Field(sequential=<span class=\"hljs-literal\">True</span>, tokenize=<span class=\"hljs-keyword\">lambda</span> x:x, include_lengths=<span class=\"hljs-literal\">True</span>) <span class=\"hljs-comment\"># Default behaviour is to tokenize by splitting</span>\nlabel_field = Field(sequential=<span class=\"hljs-literal\">True</span>, tokenize=<span class=\"hljs-keyword\">lambda</span> x:x, is_target=<span class=\"hljs-literal\">True</span>)\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">read_data</span>(<span class=\"hljs-params\">sentences</span>):\n    examples = []\n    fields = {<span class=\"hljs-string\">'sentence_labels'</span>: (<span class=\"hljs-string\">'labels'</span>, label_field),\n              <span class=\"hljs-string\">'sentence_tokens'</span>: (<span class=\"hljs-string\">'text'</span>, text_field)}\n    \n    <span class=\"hljs-keyword\">for</span> sentence <span class=\"hljs-keyword\">in</span> sentences: \n        tokens = [t[<span class=\"hljs-number\">0</span>] <span class=\"hljs-keyword\">for</span> t <span class=\"hljs-keyword\">in</span> sentence]\n        labels = [t[<span class=\"hljs-number\">2</span>] <span class=\"hljs-keyword\">for</span> t <span class=\"hljs-keyword\">in</span> sentence]\n        \n        e = Example.fromdict({<span class=\"hljs-string\">\"sentence_labels\"</span>: labels, <span class=\"hljs-string\">\"sentence_tokens\"</span>: tokens},\n                             fields=fields)\n        examples.append(e)\n    \n    <span class=\"hljs-keyword\">return</span> Dataset(examples, fields=[(<span class=\"hljs-string\">'labels'</span>, label_field), (<span class=\"hljs-string\">'text'</span>, text_field)])\n\ntrain_data = read_data(train_sents)\ndev_data = read_data(dev_sents)\ntest_data = read_data(test_sents)\n\n<span class=\"hljs-built_in\">print</span>(train_data.fields)\n<span class=\"hljs-built_in\">print</span>(train_data[<span class=\"hljs-number\">0</span>].text)\n<span class=\"hljs-built_in\">print</span>(train_data[<span class=\"hljs-number\">0</span>].labels)\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Train:\"</span>, <span class=\"hljs-built_in\">len</span>(train_data))\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Dev:\"</span>, <span class=\"hljs-built_in\">len</span>(dev_data))\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Test:\"</span>, <span class=\"hljs-built_in\">len</span>(test_data))</code></pre></div><div class=\"nb-output\" data-prompt-number=\"2\"><pre class=\"nb-stdout\">{&amp;#x27;labels&amp;#x27;: &amp;amp;<span class=\"hljs-literal\">lt</span>;torchtext.<span class=\"hljs-built_in\">data</span>.field.Field object at <span class=\"hljs-number\">0x7fc89bc02e10</span>&amp;amp;<span class=\"hljs-literal\">gt</span>;, &amp;#x27;text&amp;#x27;: &amp;amp;<span class=\"hljs-literal\">lt</span>;torchtext.<span class=\"hljs-built_in\">data</span>.field.Field object at <span class=\"hljs-number\">0x7fc89bc02eb8</span>&amp;amp;<span class=\"hljs-literal\">gt</span>;}\n<span class=\"hljs-meta\">[</span>&amp;#x27;De&amp;#x27;, &amp;#x27;tekst&amp;#x27;, &amp;#x27;van&amp;#x27;, &amp;#x27;het&amp;#x27;, &amp;#x27;arrest&amp;#x27;, &amp;#x27;is&amp;#x27;, &amp;#x27;nog&amp;#x27;, &amp;#x27;niet&amp;#x27;, &amp;#x27;schriftelijk&amp;#x27;, &amp;#x27;beschikbaar&amp;#x27;, &amp;#x27;maar&amp;#x27;, &amp;#x27;het&amp;#x27;, &amp;#x27;bericht&amp;#x27;, &amp;#x27;werd&amp;#x27;, &amp;#x27;alvast&amp;#x27;, &amp;#x27;bekendgemaakt&amp;#x27;, &amp;#x27;door&amp;#x27;, &amp;#x27;een&amp;#x27;, &amp;#x27;communicatiebureau&amp;#x27;, &amp;#x27;dat&amp;#x27;, &amp;#x27;Floralux&amp;#x27;, &amp;#x27;inhuurde&amp;#x27;, &amp;#x27;.&amp;#x27;<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-meta\">[</span>&amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;B<span class=\"hljs-params\">-ORG</span>&amp;#x27;, &amp;#x27;O&amp;#x27;, &amp;#x27;O&amp;#x27;<span class=\"hljs-meta\">]</span>\nTrain: 15806\nDev: 2895\nTest: 5195\n</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Next, we build a vocabulary for both fields. This vocabulary allows us to map every word and label to their index. One index is kept for unknown words, another one for padding.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"3\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">VOCAB_SIZE = <span class=\"hljs-number\">20000</span>\n\ntext_field.build_vocab(train_data, max_size=VOCAB_SIZE)\nlabel_field.build_vocab(train_data)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"training\">Training</h2>\n</div><div class=\"nb-cell nb-markdown-cell\"><p>If we're on a machine with a CUDA-enabled GPU, we'd like to use this GPU for training and testing. If not, we'll just use the CPU. The check below allows us to write code that works on both CPU and GPU.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"4\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> torch\n\ndevice = torch.device(<span class=\"hljs-string\">\"cuda\"</span> <span class=\"hljs-keyword\">if</span> torch.cuda.is_available() <span class=\"hljs-keyword\">else</span> <span class=\"hljs-string\">\"cpu\"</span>)\n<span class=\"hljs-built_in\">print</span>(device)</code></pre></div><div class=\"nb-output\" data-prompt-number=\"4\"><pre class=\"nb-stdout\"><span class=\"hljs-attribute\">cuda</span>\n</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Another convenient class in <code>Torchtext</code> is the BucketIterator. This iterator creates batches of similar-length examples in the data. It also takes care of mapping the words and labels to the correct indices in their vocabularies, and pads the sentences so that they all have the same length. The Bucketiterator creates batches of similar-length examples to minimize the amount of padding. </p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"5\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> torchtext.data <span class=\"hljs-keyword\">import</span> BucketIterator\n\nBATCH_SIZE = <span class=\"hljs-number\">32</span>\ntrain_iter = BucketIterator(dataset=train_data, batch_size=BATCH_SIZE, shuffle=<span class=\"hljs-literal\">True</span>, \n                            sort_key=<span class=\"hljs-keyword\">lambda</span> x: <span class=\"hljs-built_in\">len</span>(x.text), sort_within_batch=<span class=\"hljs-literal\">True</span>)\ndev_iter = BucketIterator(dataset=dev_data, batch_size=BATCH_SIZE, \n                          sort_key=<span class=\"hljs-keyword\">lambda</span> x: <span class=\"hljs-built_in\">len</span>(x.text), sort_within_batch=<span class=\"hljs-literal\">True</span>)\ntest_iter = BucketIterator(dataset=test_data, batch_size=BATCH_SIZE, \n                           sort_key=<span class=\"hljs-keyword\">lambda</span> x: <span class=\"hljs-built_in\">len</span>(x.text), sort_within_batch=<span class=\"hljs-literal\">True</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"pre-trained-embeddings\">Pre-trained embeddings</h2>\n<p>Pre-trained embeddings embeddings are generally an easy way of improving the performance of your model, particularly if you have little training data. Thanks to these embeddings, you'll be able to make use of knowledge about the meaning and use of the words in your dataset that was learned from another, typically larger data set. In this way, your model will be able to generalize better between semantically related words. </p>\n<p>In this example, we make use of the popular FastText embeddings. These are high-quality pre-trained word embeddings that are available for a wide variety of languages. After downloading the <code>vec</code> file with the embeddings, we use them to initialize our embedding matrix. We do this by creating a matrix filled with zeros whose number of rows equals the number of words in our vocabulary and whose number of columns equals the number of dimensions in the FastText vectors (300). We have to take care that we insert the FastText embedding for a particular word in the correct row. This is the row whose index corresponds to the index of the word in the vocabulary. </p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"6\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n\nEMBEDDING_PATH = os.path.join(os.path.expanduser(<span class=\"hljs-string\">\"~\"</span>), <span class=\"hljs-string\">\"data/embeddings/fasttext/cc.nl.300.vec\"</span>)\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">load_embeddings</span>(<span class=\"hljs-params\">path</span>):\n    <span class=\"hljs-string\">\"\"\" Load the FastText embeddings from the embedding file. \"\"\"</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Loading pre-trained embeddings\"</span>)\n    \n    embeddings = {}\n    <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path) <span class=\"hljs-keyword\">as</span> i:\n        <span class=\"hljs-keyword\">for</span> line <span class=\"hljs-keyword\">in</span> i:\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(line) &amp;gt; <span class=\"hljs-number\">2</span>: \n                line = line.strip().split()\n                word = line[<span class=\"hljs-number\">0</span>]\n                embedding = np.array(line[<span class=\"hljs-number\">1</span>:])\n                embeddings[word] = embedding\n    \n    <span class=\"hljs-keyword\">return</span> embeddings\n    \n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">initialize_embeddings</span>(<span class=\"hljs-params\">embeddings, vocabulary</span>):\n    <span class=\"hljs-string\">\"\"\" Use the pre-trained embeddings to initialize an embedding matrix. \"\"\"</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Initializing embedding matrix\"</span>)\n    embedding_size = <span class=\"hljs-built_in\">len</span>(embeddings[<span class=\"hljs-string\">\".\"</span>])\n    embedding_matrix = np.zeros((<span class=\"hljs-built_in\">len</span>(vocabulary), embedding_size), dtype=np.float32)\n                                \n    <span class=\"hljs-keyword\">for</span> idx, word <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">enumerate</span>(vocabulary.itos): \n        <span class=\"hljs-keyword\">if</span> word <span class=\"hljs-keyword\">in</span> embeddings:\n            embedding_matrix[idx,:] = embeddings[word]\n            \n    <span class=\"hljs-keyword\">return</span> embedding_matrix\n\nembeddings = load_embeddings(EMBEDDING_PATH)\nembedding_matrix = initialize_embeddings(embeddings, text_field.vocab)\nembedding_matrix = torch.from_numpy(embedding_matrix).to(device)</code></pre></div><div class=\"nb-output\" data-prompt-number=\"6\"><pre class=\"nb-stdout\"><span class=\"hljs-attribute\">Loading pre-trained embeddings\nInitializing embedding matrix</span>\n</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"model\">Model</h2>\n<p>Next, we create our BiLSTM model. It consists of four layers:</p>\n<ul>\n<li>An embedding layer that maps one-hot word vectors to dense word embeddings. These embeddings are either pretrained or trained from scratch.</li>\n<li>A bidirectional LSTM layer that reads the text both front to back and back to front. For each word, this LSTM produces two output vectors of dimensionality <code>hidden_dim</code>, which are concatenated to a vector of <code>2*hidden_dim</code>.</li>\n<li>A dropout layer that helps us avoid overfitting by dropping a certain percentage of the items in the LSTM output.</li>\n<li>A dense layer that projects the LSTM output to an output vector with a dimensionality equal to the number of labels.</li>\n</ul>\n<p>We initialize these layers in the <code>__init__</code> method, and put them together in the <code>forward</code> method.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"7\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> torch.nn <span class=\"hljs-keyword\">as</span> nn\n<span class=\"hljs-keyword\">from</span> torch.nn.utils.rnn <span class=\"hljs-keyword\">import</span> pack_padded_sequence, pad_packed_sequence\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BiLSTMTagger</span>(nn.Module):\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, embedding_dim, hidden_dim, vocab_size, output_size, embeddings=<span class=\"hljs-literal\">None</span></span>):\n        <span class=\"hljs-built_in\">super</span>(BiLSTMTagger, self).__init__()\n        \n        <span class=\"hljs-comment\"># 1. Embedding Layer</span>\n        <span class=\"hljs-keyword\">if</span> embeddings <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">None</span>:\n            self.embeddings = nn.Embedding(vocab_size, embedding_dim)\n        <span class=\"hljs-keyword\">else</span>:\n            self.embeddings = nn.Embedding.from_pretrained(embeddings)\n        \n        <span class=\"hljs-comment\"># 2. LSTM Layer</span>\n        self.lstm = nn.LSTM(embedding_dim, hidden_dim, bidirectional=<span class=\"hljs-literal\">True</span>, num_layers=<span class=\"hljs-number\">1</span>)\n        \n        <span class=\"hljs-comment\"># 3. Optional dropout layer</span>\n        self.dropout_layer = nn.Dropout(p=<span class=\"hljs-number\">0.5</span>)\n\n        <span class=\"hljs-comment\"># 4. Dense Layer</span>\n        self.hidden2tag = nn.Linear(<span class=\"hljs-number\">2</span>*hidden_dim, output_size)\n        \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">forward</span>(<span class=\"hljs-params\">self, batch_text, batch_lengths</span>):\n\n        embeddings = self.embeddings(batch_text)\n        \n        packed_seqs = pack_padded_sequence(embeddings, batch_lengths)\n        lstm_output, _ = self.lstm(packed_seqs)\n        lstm_output, _ = pad_packed_sequence(lstm_output)\n        lstm_output = self.dropout_layer(lstm_output)\n        \n        logits = self.hidden2tag(lstm_output)\n        <span class=\"hljs-keyword\">return</span> logits</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"training\">Training</h2>\n<p>Then we need to train this model. This involves taking a number of decisions: </p>\n<ul>\n<li>We pick a loss function (or <code>criterion</code>) to quantify how far away the model predictions are from the correct output. For multiclass tasks such as Named Entity Recognition, a standard loss function is the Cross-Entropy Loss, which here measures the difference between two multinomial probability distributions. PyTorch's <code>CrossEntropyLoss</code> does this by first applying a <code>softmax</code> to the last layer of the model to transform the output scores to probabilities, and then computing the cross-entropy between the predicted and correct probability distributions. The <code>ignore_index</code> parameter allows us to mask the padding items in the training data, so that these do not contribute to the loss. We also remove these masked items from the output afterwards, so they are not taken into account when we evaluate the model output.</li>\n<li>Next, we need to choose an optimizer. For many NLP problems, the Adam optimizer is a good first choice. Adam is a variation of Stochastic Gradient Descent with several advantages: it maintains per-parameter learning rates and adapts these learning rates based on how quickly the values of a specific parameter are changing (or, how large its average gradient is).</li>\n</ul>\n<p>Then the actual training starts. This happens in several epochs. During each epoch, we show all of the training data to the network, in the batches produced by the BucketIterators we created above. Before we show the model a new batch, we set the gradients of the model to zero to avoid accumulating gradients across batches. Then we let the model make its predictions for the batch. We do this by taking the output, and finding out what label received the highest score, using the <code>torch.max</code> method. We then compute the loss with respect to the correct labels. <code>loss.backward()</code> then computes the gradients for all model parameters; <code>optimizer.step()</code> performs an optimization step.</p>\n<p>When we have shown all the training data in an epoch, we perform the precision, recall and F-score on the training data and development data. Note that we compute the loss for the development data, but we do not optimize the model with it. Whenever the F-score on the development data is better than before, we save the model. If the F-score is lower than the minimum F-score we've seen in the past few epochs (we call this number the patience), we stop training.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"8\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> torch.optim <span class=\"hljs-keyword\">as</span> optim\n<span class=\"hljs-keyword\">from</span> tqdm <span class=\"hljs-keyword\">import</span> tqdm_notebook <span class=\"hljs-keyword\">as</span> tqdm\n<span class=\"hljs-keyword\">from</span> sklearn.metrics <span class=\"hljs-keyword\">import</span> precision_recall_fscore_support, classification_report\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">remove_predictions_for_masked_items</span>(<span class=\"hljs-params\">predicted_labels, correct_labels</span>): \n\n    predicted_labels_without_mask = []\n    correct_labels_without_mask = []\n        \n    <span class=\"hljs-keyword\">for</span> p, c <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">zip</span>(predicted_labels, correct_labels):\n        <span class=\"hljs-keyword\">if</span> c &amp;gt; <span class=\"hljs-number\">1</span>:\n            predicted_labels_without_mask.append(p)\n            correct_labels_without_mask.append(c)\n            \n    <span class=\"hljs-keyword\">return</span> predicted_labels_without_mask, correct_labels_without_mask\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">train</span>(<span class=\"hljs-params\">model, train_iter, dev_iter, batch_size, max_epochs, num_batches, patience, output_path</span>):\n    criterion = nn.CrossEntropyLoss(ignore_index=<span class=\"hljs-number\">1</span>)  <span class=\"hljs-comment\"># we mask the &amp;lt;pad&amp;gt; labels</span>\n    optimizer = optim.Adam(model.parameters())\n\n    train_f_score_history = []\n    dev_f_score_history = []\n    no_improvement = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">for</span> epoch <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(max_epochs):\n\n        total_loss = <span class=\"hljs-number\">0</span>\n        predictions, correct = [], []\n        <span class=\"hljs-keyword\">for</span> batch <span class=\"hljs-keyword\">in</span> tqdm(train_iter, total=num_batches, desc=<span class=\"hljs-string\">f\"Epoch <span class=\"hljs-subst\">{epoch}</span>\"</span>):\n            optimizer.zero_grad()\n            \n            text_length, cur_batch_size = batch.text[<span class=\"hljs-number\">0</span>].shape\n            \n            pred = model(batch.text[<span class=\"hljs-number\">0</span>].to(device), batch.text[<span class=\"hljs-number\">1</span>].to(device)).view(cur_batch_size*text_length, NUM_CLASSES)\n            gold = batch.labels.to(device).view(cur_batch_size*text_length)\n            \n            loss = criterion(pred, gold)\n            \n            total_loss += loss.item()\n\n            loss.backward()\n            optimizer.step()\n\n            _, pred_indices = torch.<span class=\"hljs-built_in\">max</span>(pred, <span class=\"hljs-number\">1</span>)\n            \n            predicted_labels = <span class=\"hljs-built_in\">list</span>(pred_indices.cpu().numpy())\n            correct_labels = <span class=\"hljs-built_in\">list</span>(batch.labels.view(cur_batch_size*text_length).numpy())\n            \n            predicted_labels, correct_labels = remove_predictions_for_masked_items(predicted_labels, \n                                                                                   correct_labels)\n            \n            predictions += predicted_labels\n            correct += correct_labels\n\n        train_scores = precision_recall_fscore_support(correct, predictions, average=<span class=\"hljs-string\">\"micro\"</span>)\n        train_f_score_history.append(train_scores[<span class=\"hljs-number\">2</span>])\n            \n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Total training loss:\"</span>, total_loss)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Training performance:\"</span>, train_scores)\n        \n        total_loss = <span class=\"hljs-number\">0</span>\n        predictions, correct = [], []\n        <span class=\"hljs-keyword\">for</span> batch <span class=\"hljs-keyword\">in</span> dev_iter:\n\n            text_length, cur_batch_size = batch.text[<span class=\"hljs-number\">0</span>].shape\n\n            pred = model(batch.text[<span class=\"hljs-number\">0</span>].to(device), batch.text[<span class=\"hljs-number\">1</span>].to(device)).view(cur_batch_size * text_length, NUM_CLASSES)\n            gold = batch.labels.to(device).view(cur_batch_size * text_length)\n            loss = criterion(pred, gold)\n            total_loss += loss.item()\n\n            _, pred_indices = torch.<span class=\"hljs-built_in\">max</span>(pred, <span class=\"hljs-number\">1</span>)\n            predicted_labels = <span class=\"hljs-built_in\">list</span>(pred_indices.cpu().numpy())\n            correct_labels = <span class=\"hljs-built_in\">list</span>(batch.labels.view(cur_batch_size*text_length).numpy())\n            \n            predicted_labels, correct_labels = remove_predictions_for_masked_items(predicted_labels, \n                                                                                   correct_labels)\n            \n            predictions += predicted_labels\n            correct += correct_labels\n\n        dev_scores = precision_recall_fscore_support(correct, predictions, average=<span class=\"hljs-string\">\"micro\"</span>)\n            \n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Total development loss:\"</span>, total_loss)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Development performance:\"</span>, dev_scores)\n        \n        dev_f = dev_scores[<span class=\"hljs-number\">2</span>]\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(dev_f_score_history) &amp;gt; patience <span class=\"hljs-keyword\">and</span> dev_f &amp;lt; <span class=\"hljs-built_in\">max</span>(dev_f_score_history):\n            no_improvement += <span class=\"hljs-number\">1</span>\n\n        <span class=\"hljs-keyword\">elif</span> <span class=\"hljs-built_in\">len</span>(dev_f_score_history) == <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">or</span> dev_f &amp;gt; <span class=\"hljs-built_in\">max</span>(dev_f_score_history):\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Saving model.\"</span>)\n            torch.save(model, output_path)\n            no_improvement = <span class=\"hljs-number\">0</span>\n            \n        <span class=\"hljs-keyword\">if</span> no_improvement &amp;gt; patience:\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Development F-score does not improve anymore. Stop training.\"</span>)\n            dev_f_score_history.append(dev_f)\n            <span class=\"hljs-keyword\">break</span>\n            \n        dev_f_score_history.append(dev_f)\n        \n    <span class=\"hljs-keyword\">return</span> train_f_score_history, dev_f_score_history</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>When we test the model, we basically take the same steps as in the evaluation on the development data above: we get the predictions, remove the masked items and print a classification report. </p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"9\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test</span>(<span class=\"hljs-params\">model, test_iter, batch_size, labels, target_names</span>): \n    \n    total_loss = <span class=\"hljs-number\">0</span>\n    predictions, correct = [], []\n    <span class=\"hljs-keyword\">for</span> batch <span class=\"hljs-keyword\">in</span> test_iter:\n\n        text_length, cur_batch_size = batch.text[<span class=\"hljs-number\">0</span>].shape\n\n        pred = model(batch.text[<span class=\"hljs-number\">0</span>].to(device), batch.text[<span class=\"hljs-number\">1</span>].to(device)).view(cur_batch_size * text_length, NUM_CLASSES)\n        gold = batch.labels.to(device).view(cur_batch_size * text_length)\n\n        _, pred_indices = torch.<span class=\"hljs-built_in\">max</span>(pred, <span class=\"hljs-number\">1</span>)\n        predicted_labels = <span class=\"hljs-built_in\">list</span>(pred_indices.cpu().numpy())\n        correct_labels = <span class=\"hljs-built_in\">list</span>(batch.labels.view(cur_batch_size*text_length).numpy())\n\n        predicted_labels, correct_labels = remove_predictions_for_masked_items(predicted_labels, \n                                                                               correct_labels)\n\n        predictions += predicted_labels\n        correct += correct_labels\n    \n    <span class=\"hljs-built_in\">print</span>(classification_report(correct, predictions, labels=labels, target_names=target_names))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Now we can start the actual training. We set the embedding dimension to 300 (the dimensionality of the FastText embeddings), and pick a hidden dimensionality for each component of the BiLSTM (which will therefore output 512-dimensional vectors). The number of classes (the length of the vocabulary of the label field) will become the dimensionality of the output layer. Finally, we also compute the number of batches in an epoch, so that we can show a progress bar.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"10\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> math\n\nEMBEDDING_DIM = <span class=\"hljs-number\">300</span>\nHIDDEN_DIM = <span class=\"hljs-number\">256</span>\nNUM_CLASSES = <span class=\"hljs-built_in\">len</span>(label_field.vocab)\nMAX_EPOCHS = <span class=\"hljs-number\">50</span>\nPATIENCE = <span class=\"hljs-number\">3</span>\nOUTPUT_PATH = <span class=\"hljs-string\">\"/tmp/bilstmtagger\"</span>\nnum_batches = math.ceil(<span class=\"hljs-built_in\">len</span>(train_data) / BATCH_SIZE)\n\ntagger = BiLSTMTagger(EMBEDDING_DIM, HIDDEN_DIM, VOCAB_SIZE+<span class=\"hljs-number\">2</span>, NUM_CLASSES, embeddings=embedding_matrix)  \n\ntrain_f, dev_f = train(tagger.to(device), train_iter, dev_iter, BATCH_SIZE, MAX_EPOCHS, \n                       num_batches, PATIENCE, OUTPUT_PATH)</code></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 0&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">222</span>.<span class=\"hljs-number\">35497660934925</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9244241132231894</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9244241132231894</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9244241132231894</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">24</span>.<span class=\"hljs-number\">117380052804947</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9296043728606681</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9296043728606681</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9296043728606681</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stderr\"><span class=\"hljs-regexp\">/opt/</span>anaconda3<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span><span class=\"hljs-regexp\">/site-packages/</span>torch/serialization.py:<span class=\"hljs-number\">251</span>: UserWarning: Couldn&amp;<span class=\"hljs-comment\">#x27;t retrieve source code for container of type BiLSTMTagger. It won&amp;#x27;t be checked for correctness upon loading.</span>\n  &amp;quot;type &amp;quot; + obj.__name__ + &amp;quot;. It won&amp;<span class=\"hljs-comment\">#x27;t be checked &amp;quot;</span>\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 1&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">71</span>.<span class=\"hljs-number\">356663974002</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9591253627050393</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9591253627050393</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9591253627050393</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">18</span>.<span class=\"hljs-number\">751499708741903</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9388913949107119</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9388913949107119</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9388913949107119</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 2&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">50</span>.<span class=\"hljs-number\">72972834017128</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9680819565346124</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9680819565346124</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9680819565346124</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">17</span>.<span class=\"hljs-number\">262520626187325</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9425531350333006</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9425531350333006</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9425531350333006</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 3&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">41</span>.<span class=\"hljs-number\">36486494448036</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9728291980024082</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9728291980024082</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9728291980024082</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">16</span>.<span class=\"hljs-number\">504801526665688</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9443309363971661</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9443309363971661</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9443309363971661</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 4&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">35</span>.<span class=\"hljs-number\">585738136898726</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9755877302066679</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9755877302066679</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9755877302066679</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">16</span>.<span class=\"hljs-number\">711221787147224</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9458964629713164</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9458964629713164</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9458964629713164</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 5&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">30</span>.<span class=\"hljs-number\">99800857482478</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9784597619470599</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9784597619470599</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9784597619470599</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">16</span>.<span class=\"hljs-number\">387646575458348</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9469578369198928</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9469578369198928</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9469578369198928</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 6&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">27</span>.<span class=\"hljs-number\">11286850180477</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9801326464144016</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9801326464144016</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9801326464144016</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">17</span>.<span class=\"hljs-number\">557277165353298</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9460822034123172</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9460822034123172</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9460822034123172</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 7&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">24</span>.<span class=\"hljs-number\">422367892228067</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9820917471032945</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9820917471032945</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9820917471032945</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">16</span>.<span class=\"hljs-number\">09378209663555</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9491867222119033</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9491867222119033</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9491867222119033</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 8&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">22</span>.<span class=\"hljs-number\">412145966896787</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9829355914806261</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9829355914806261</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9829355914806261</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">19</span>.<span class=\"hljs-number\">413369961082935</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9440390585613077</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9440390585613077</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9440390585613077</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 9&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">ini</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">20</span>.<span class=\"hljs-number\">09223960270174</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9845344545113598</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9845344545113598</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9845344545113598</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">15</span>.<span class=\"hljs-number\">523855119943619</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">948072279565898</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">948072279565898</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">948072279565898</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 10&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">in</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">17</span>.<span class=\"hljs-number\">925453061121516</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9860395570557233</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9860395570557233</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9860395570557233</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">16</span>.<span class=\"hljs-number\">789274506270885</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9485233634940431</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9485233634940431</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9485233634940432</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 11&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">in</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">16</span>.<span class=\"hljs-number\">409397734270897</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9867205542725174</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9867205542725174</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9867205542725174</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">14</span>.<span class=\"hljs-number\">920704647898674</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">950195027463051</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">950195027463051</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">950195027463051</span>, None)\n<span class=\"hljs-attribute\">Saving</span> model.\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 12&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">in</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">14</span>.<span class=\"hljs-number\">990085303143132</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9879493101202108</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9879493101202108</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9879493101202108</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">17</span>.<span class=\"hljs-number\">077377565205097</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">949876615278478</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">949876615278478</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">949876615278478</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 13&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">in</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">13</span>.<span class=\"hljs-number\">492025993036805</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9886845897238506</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9886845897238506</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9886845897238506</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">19</span>.<span class=\"hljs-number\">90118957636878</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9481253482633268</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9481253482633268</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9481253482633268</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 14&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">in</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">12</span>.<span class=\"hljs-number\">34741208187188</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9893507826533231</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9893507826533231</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9893507826533231</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">18</span>.<span class=\"hljs-number\">731272239238024</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9497970122323347</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9497970122323347</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9497970122323347</span>, None)\n</pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-text-output\"><span class=\"hljs-constructor\">HBox(<span class=\"hljs-params\">children</span>=(IntProgress(<span class=\"hljs-params\">value</span>=0, <span class=\"hljs-params\">description</span>=&amp;#<span class=\"hljs-params\">x27</span>;Epoch 15&amp;#<span class=\"hljs-params\">x27</span>;, <span class=\"hljs-params\">max</span>=494, <span class=\"hljs-params\">style</span>=ProgressStyle(<span class=\"hljs-params\">description_width</span>=&amp;#<span class=\"hljs-params\">x27</span>;<span class=\"hljs-params\">in</span>…</span></pre></div><div class=\"nb-output\" data-prompt-number=\"10\"><pre class=\"nb-stdout\">\n<span class=\"hljs-attribute\">Total</span> training loss: <span class=\"hljs-number\">10</span>.<span class=\"hljs-number\">979540771790198</span>\n<span class=\"hljs-attribute\">Training</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9901650184560116</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9901650184560116</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">9901650184560116</span>, None)\n<span class=\"hljs-attribute\">Total</span> development loss: <span class=\"hljs-number\">17</span>.<span class=\"hljs-number\">838901833223645</span>\n<span class=\"hljs-attribute\">Development</span> performance: (<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">949558203093905</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">949558203093905</span>, <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">949558203093905</span>, None)\n<span class=\"hljs-attribute\">Development</span> F-score does not improve anymore. Stop training.\n</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Let's now plot the evolution of the F-score on our training and development set, to visually evaluate if training went well. If it did, the training F-score should first increase suddenly, then more gradually. The development F-score will increase during the first few epochs, but at some point it will start to decrease again. That's when the model starts overfitting. This is where we abandon training, and why we only save the model when we have reached an optimal F-score on the development data.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"11\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">%matplotlib notebook\n%matplotlib inline\n\n<span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\n<span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\n\n<span class=\"hljs-comment\"># Data</span>\ndf = pd.DataFrame({<span class=\"hljs-string\">'epochs'</span>: <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-built_in\">len</span>(train_f)), \n                  <span class=\"hljs-string\">'train_f'</span>: train_f, \n                   <span class=\"hljs-string\">'dev_f'</span>: dev_f})\n \n<span class=\"hljs-comment\"># multiple line plot</span>\nplt.plot(<span class=\"hljs-string\">'epochs'</span>, <span class=\"hljs-string\">'train_f'</span>, data=df, color=<span class=\"hljs-string\">'blue'</span>, linewidth=<span class=\"hljs-number\">2</span>)\nplt.plot(<span class=\"hljs-string\">'epochs'</span>, <span class=\"hljs-string\">'dev_f'</span>, data=df, color=<span class=\"hljs-string\">'green'</span>, linewidth=<span class=\"hljs-number\">2</span>)\nplt.legend()\nplt.show()\n</code></pre></div><div class=\"nb-output\" data-prompt-number=\"11\"><img class=\"nb-image-output\" src=\"data:image/png;base64,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\"></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Before we test our model on the test data, we have to run its <code>eval()</code> method. This will put the model in eval mode, and deactivate dropout layers and other functionality that is only useful in training.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"12\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">tagger = torch.load(OUTPUT_PATH)\ntagger.<span class=\"hljs-built_in\">eval</span>()</code></pre></div><div class=\"nb-output\" data-prompt-number=\"12\"><pre class=\"nb-text-output\">BiLSTMTagger(\n  (embeddings): Embedding(20002, 300)\n  (lstm): LSTM(300, 256, <span class=\"hljs-attribute\">bidirectional</span>=<span class=\"hljs-literal\">True</span>)\n  (dropout_layer): Dropout(<span class=\"hljs-attribute\">p</span>=0.5)\n  (hidden2tag): Linear(<span class=\"hljs-attribute\">in_features</span>=512, <span class=\"hljs-attribute\">out_features</span>=11, <span class=\"hljs-attribute\">bias</span>=<span class=\"hljs-literal\">True</span>)\n)</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Finally, we test the model. You'll notice its performance is significantly lower than that of the CRF we explored in an earlier notebook. Designing a competitive neural network takes considerably more effort than we put in here: you'll need to make the architecture of the network more complex, optimize its hyperparameters, and often also throw considerably more data at your model.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"13\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">labels = label_field.vocab.itos[<span class=\"hljs-number\">3</span>:]\nlabels = <span class=\"hljs-built_in\">sorted</span>(labels, key=<span class=\"hljs-keyword\">lambda</span> x: x.split(<span class=\"hljs-string\">\"-\"</span>)[-<span class=\"hljs-number\">1</span>])\nlabel_idxs = [label_field.vocab.stoi[l] <span class=\"hljs-keyword\">for</span> l <span class=\"hljs-keyword\">in</span> labels]\n\ntest(tagger, test_iter, BATCH_SIZE, labels = label_idxs, target_names = labels)</code></pre></div><div class=\"nb-output\" data-prompt-number=\"13\"><pre class=\"nb-stdout\">             <span class=\"hljs-attribute\">precision</span>    recall  f1-score   support\n\n      <span class=\"hljs-attribute\">B</span>-LOC       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">83</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">67</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">75</span>       <span class=\"hljs-number\">774</span>\n      <span class=\"hljs-attribute\">I</span>-LOC       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">42</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">45</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">44</span>        <span class=\"hljs-number\">49</span>\n     <span class=\"hljs-attribute\">B</span>-MISC       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">83</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">48</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">60</span>      <span class=\"hljs-number\">1187</span>\n     <span class=\"hljs-attribute\">I</span>-MISC       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">58</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">25</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">35</span>       <span class=\"hljs-number\">410</span>\n      <span class=\"hljs-attribute\">B</span>-ORG       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">72</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">56</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">63</span>       <span class=\"hljs-number\">882</span>\n      <span class=\"hljs-attribute\">I</span>-ORG       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">74</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">57</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">64</span>       <span class=\"hljs-number\">551</span>\n      <span class=\"hljs-attribute\">B</span>-PER       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">82</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">68</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">74</span>      <span class=\"hljs-number\">1098</span>\n      <span class=\"hljs-attribute\">I</span>-PER       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">95</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">71</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">81</span>       <span class=\"hljs-number\">807</span>\n\n<span class=\"hljs-attribute\">avg</span> / total       <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">80</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">58</span>      <span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">67</span>      <span class=\"hljs-number\">5758</span>\n\n</pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"conclusion\">Conclusion</h1>\n<p>In this notebook we've trained a simple bidirectional LSTM for named entity recognition. Far from achieving state-of-the-art performance, our aim was to understand how neural networks can be implemented and trained in PyTorch. To improve our performance, one of the things that is typically done is to add an additional CRF layer to the neural network. This layer helps us optimize the complete label sequence, and not the labels individually. We leave that for future work. </p>\n</div></div></div>"
  },
  "implementations": {
    "jupyter": {
      "dir": "neural_network/Sequence Labelling with a BiLSTM in PyTorch.ipynb",
      "url": "https://github.com/TheAlgorithms/jupyter/tree/master/neural_network/Sequence Labelling with a BiLSTM in PyTorch.ipynb",
      "code": "<span class=\"hljs-punctuation\">{</span>\n <span class=\"hljs-attr\">&quot;cells&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;# Named Entity Recognition with PyTorch&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;In this notebook we&#x27;ll explore how we can use Deep Learning for sequence labelling tasks such as part-of-speech tagging or named entity recognition. We won&#x27;t focus on getting state-of-the-art accuracy, but rather, implement a first neural network to get the main concepts across.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;## Data&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;For our experiments we&#x27;ll reuse the NER data we&#x27;ve already used for our CRF experiments. The Dutch CoNLL-2002 data has four kinds of named entities (people, locations, organizations and miscellaneous entities) and comes split into a training, development and test set. &quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;[[(&#x27;De&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;tekst&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;van&#x27;, &#x27;Prep&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;het&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;arrest&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;is&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;nog&#x27;, &#x27;Adv&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;niet&#x27;, &#x27;Adv&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;schriftelijk&#x27;, &#x27;Adj&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;beschikbaar&#x27;, &#x27;Adj&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;maar&#x27;, &#x27;Conj&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;het&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;bericht&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;werd&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;alvast&#x27;, &#x27;Adv&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;bekendgemaakt&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;door&#x27;, &#x27;Prep&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;een&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;communicatiebureau&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;dat&#x27;, &#x27;Conj&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;Floralux&#x27;, &#x27;N&#x27;, &#x27;B-ORG&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;inhuurde&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;.&#x27;, &#x27;Punc&#x27;, &#x27;O&#x27;)],\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot; [(&#x27;In&#x27;, &#x27;Prep&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (\\&quot;&#x27;81\\&quot;, &#x27;Num&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;regulariseert&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;de&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;toenmalige&#x27;, &#x27;Adj&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;Vlaamse&#x27;, &#x27;Adj&#x27;, &#x27;B-MISC&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;regering&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;de&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;toestand&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;met&#x27;, &#x27;Prep&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;een&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;BPA&#x27;, &#x27;N&#x27;, &#x27;B-MISC&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;dat&#x27;, &#x27;Pron&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;het&#x27;, &#x27;Art&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;bedrijf&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;op&#x27;, &#x27;Prep&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;eigen&#x27;, &#x27;Pron&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;kosten&#x27;, &#x27;N&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;heeft&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;laten&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;opstellen&#x27;, &#x27;V&#x27;, &#x27;O&#x27;),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (&#x27;.&#x27;, &#x27;Punc&#x27;, &#x27;O&#x27;)],\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot; [(&#x27;publicatie&#x27;, &#x27;N&#x27;, &#x27;O&#x27;)]]&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;execute_result&quot;</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;import nltk\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;train_sents = list(nltk.corpus.conll2002.iob_sents(&#x27;ned.train&#x27;))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;dev_sents = list(nltk.corpus.conll2002.iob_sents(&#x27;ned.testa&#x27;))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;test_sents = list(nltk.corpus.conll2002.iob_sents(&#x27;ned.testb&#x27;))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;train_sents[:3]&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Next, we&#x27;re going to preprocess the data. For this we use the `torchtext` Python library, which has a number of handy  utilities for preprocessing natural language. We process our data to a Dataset that consists of Examples. Each of these examples has two fields: a text field and a label field. Both contain sequential information (the sequence of tokens, and the sequence of labels). We don&#x27;t have to tokenize this information anymore, as the CONLL data has already been tokenized for us.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;{&#x27;labels&#x27;: &lt;torchtext.data.field.Field object at 0x7fc89bc02e10&gt;, &#x27;text&#x27;: &lt;torchtext.data.field.Field object at 0x7fc89bc02eb8&gt;}\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;[&#x27;De&#x27;, &#x27;tekst&#x27;, &#x27;van&#x27;, &#x27;het&#x27;, &#x27;arrest&#x27;, &#x27;is&#x27;, &#x27;nog&#x27;, &#x27;niet&#x27;, &#x27;schriftelijk&#x27;, &#x27;beschikbaar&#x27;, &#x27;maar&#x27;, &#x27;het&#x27;, &#x27;bericht&#x27;, &#x27;werd&#x27;, &#x27;alvast&#x27;, &#x27;bekendgemaakt&#x27;, &#x27;door&#x27;, &#x27;een&#x27;, &#x27;communicatiebureau&#x27;, &#x27;dat&#x27;, &#x27;Floralux&#x27;, &#x27;inhuurde&#x27;, &#x27;.&#x27;]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;[&#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;O&#x27;, &#x27;B-ORG&#x27;, &#x27;O&#x27;, &#x27;O&#x27;]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Train: 15806\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Dev: 2895\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Test: 5195\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;from torchtext.data import Example\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;from torchtext.data import Field, Dataset\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;text_field = Field(sequential=True, tokenize=lambda x:x, include_lengths=True) # Default behaviour is to tokenize by splitting\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;label_field = Field(sequential=True, tokenize=lambda x:x, is_target=True)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;def read_data(sentences):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    examples = []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    fields = {&#x27;sentence_labels&#x27;: (&#x27;labels&#x27;, label_field),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;              &#x27;sentence_tokens&#x27;: (&#x27;text&#x27;, text_field)}\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    for sentence in sentences: \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        tokens = [t[0] for t in sentence]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        labels = [t[2] for t in sentence]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        e = Example.fromdict({\\&quot;sentence_labels\\&quot;: labels, \\&quot;sentence_tokens\\&quot;: tokens},\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                             fields=fields)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        examples.append(e)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    return Dataset(examples, fields=[(&#x27;labels&#x27;, label_field), (&#x27;text&#x27;, text_field)])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;train_data = read_data(train_sents)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;dev_data = read_data(dev_sents)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;test_data = read_data(test_sents)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(train_data.fields)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(train_data[0].text)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(train_data[0].labels)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(\\&quot;Train:\\&quot;, len(train_data))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(\\&quot;Dev:\\&quot;, len(dev_data))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(\\&quot;Test:\\&quot;, len(test_data))&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Next, we build a vocabulary for both fields. This vocabulary allows us to map every word and label to their index. One index is kept for unknown words, another one for padding.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">3</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;VOCAB_SIZE = 20000\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;text_field.build_vocab(train_data, max_size=VOCAB_SIZE)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;label_field.build_vocab(train_data)&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;## Training&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;If we&#x27;re on a machine with a CUDA-enabled GPU, we&#x27;d like to use this GPU for training and testing. If not, we&#x27;ll just use the CPU. The check below allows us to write code that works on both CPU and GPU.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;cuda\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;import torch\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;device = torch.device(\\&quot;cuda\\&quot; if torch.cuda.is_available() else \\&quot;cpu\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;print(device)&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Another convenient class in `Torchtext` is the BucketIterator. This iterator creates batches of similar-length examples in the data. It also takes care of mapping the words and labels to the correct indices in their vocabularies, and pads the sentences so that they all have the same length. The Bucketiterator creates batches of similar-length examples to minimize the amount of padding. &quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">5</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;from torchtext.data import BucketIterator\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;BATCH_SIZE = 32\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;train_iter = BucketIterator(dataset=train_data, batch_size=BATCH_SIZE, shuffle=True, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                            sort_key=lambda x: len(x.text), sort_within_batch=True)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;dev_iter = BucketIterator(dataset=dev_data, batch_size=BATCH_SIZE, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                          sort_key=lambda x: len(x.text), sort_within_batch=True)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;test_iter = BucketIterator(dataset=test_data, batch_size=BATCH_SIZE, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                           sort_key=lambda x: len(x.text), sort_within_batch=True)&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;## Pre-trained embeddings\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;Pre-trained embeddings embeddings are generally an easy way of improving the performance of your model, particularly if you have little training data. Thanks to these embeddings, you&#x27;ll be able to make use of knowledge about the meaning and use of the words in your dataset that was learned from another, typically larger data set. In this way, your model will be able to generalize better between semantically related words. \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;In this example, we make use of the popular FastText embeddings. These are high-quality pre-trained word embeddings that are available for a wide variety of languages. After downloading the `vec` file with the embeddings, we use them to initialize our embedding matrix. We do this by creating a matrix filled with zeros whose number of rows equals the number of words in our vocabulary and whose number of columns equals the number of dimensions in the FastText vectors (300). We have to take care that we insert the FastText embedding for a particular word in the correct row. This is the row whose index corresponds to the index of the word in the vocabulary. &quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">6</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;Loading pre-trained embeddings\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Initializing embedding matrix\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;import random\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;import os\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;import numpy as np\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;EMBEDDING_PATH = os.path.join(os.path.expanduser(\\&quot;~\\&quot;), \\&quot;data/embeddings/fasttext/cc.nl.300.vec\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;def load_embeddings(path):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\&quot;\\&quot;\\&quot; Load the FastText embeddings from the embedding file. \\&quot;\\&quot;\\&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    print(\\&quot;Loading pre-trained embeddings\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    embeddings = {}\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    with open(path) as i:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        for line in i:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            if len(line) &gt; 2: \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                line = line.strip().split()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                word = line[0]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                embedding = np.array(line[1:])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                embeddings[word] = embedding\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    return embeddings\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;def initialize_embeddings(embeddings, vocabulary):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\&quot;\\&quot;\\&quot; Use the pre-trained embeddings to initialize an embedding matrix. \\&quot;\\&quot;\\&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    print(\\&quot;Initializing embedding matrix\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    embedding_size = len(embeddings[\\&quot;.\\&quot;])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    embedding_matrix = np.zeros((len(vocabulary), embedding_size), dtype=np.float32)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                                \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    for idx, word in enumerate(vocabulary.itos): \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        if word in embeddings:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            embedding_matrix[idx,:] = embeddings[word]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    return embedding_matrix\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;embeddings = load_embeddings(EMBEDDING_PATH)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;embedding_matrix = initialize_embeddings(embeddings, text_field.vocab)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;embedding_matrix = torch.from_numpy(embedding_matrix).to(device)&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;## Model\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;Next, we create our BiLSTM model. It consists of four layers:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;- An embedding layer that maps one-hot word vectors to dense word embeddings. These embeddings are either pretrained or trained from scratch.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;- A bidirectional LSTM layer that reads the text both front to back and back to front. For each word, this LSTM produces two output vectors of dimensionality `hidden_dim`, which are concatenated to a vector of `2*hidden_dim`.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;- A dropout layer that helps us avoid overfitting by dropping a certain percentage of the items in the LSTM output.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;- A dense layer that projects the LSTM output to an output vector with a dimensionality equal to the number of labels.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;We initialize these layers in the `__init__` method, and put them together in the `forward` method.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">7</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;import torch.nn as nn\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;from torch.nn.utils.rnn import pack_padded_sequence, pad_packed_sequence\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;class BiLSTMTagger(nn.Module):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    def __init__(self, embedding_dim, hidden_dim, vocab_size, output_size, embeddings=None):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        super(BiLSTMTagger, self).__init__()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        # 1. Embedding Layer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        if embeddings is None:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            self.embeddings = nn.Embedding(vocab_size, embedding_dim)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        else:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            self.embeddings = nn.Embedding.from_pretrained(embeddings)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        # 2. LSTM Layer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        self.lstm = nn.LSTM(embedding_dim, hidden_dim, bidirectional=True, num_layers=1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        # 3. Optional dropout layer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        self.dropout_layer = nn.Dropout(p=0.5)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        # 4. Dense Layer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        self.hidden2tag = nn.Linear(2*hidden_dim, output_size)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    def forward(self, batch_text, batch_lengths):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        embeddings = self.embeddings(batch_text)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        packed_seqs = pack_padded_sequence(embeddings, batch_lengths)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        lstm_output, _ = self.lstm(packed_seqs)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        lstm_output, _ = pad_packed_sequence(lstm_output)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        lstm_output = self.dropout_layer(lstm_output)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        logits = self.hidden2tag(lstm_output)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        return logits&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;## Training\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;Then we need to train this model. This involves taking a number of decisions: \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;- We pick a loss function (or `criterion`) to quantify how far away the model predictions are from the correct output. For multiclass tasks such as Named Entity Recognition, a standard loss function is the Cross-Entropy Loss, which here measures the difference between two multinomial probability distributions. PyTorch&#x27;s `CrossEntropyLoss` does this by first applying a `softmax` to the last layer of the model to transform the output scores to probabilities, and then computing the cross-entropy between the predicted and correct probability distributions. The `ignore_index` parameter allows us to mask the padding items in the training data, so that these do not contribute to the loss. We also remove these masked items from the output afterwards, so they are not taken into account when we evaluate the model output.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;- Next, we need to choose an optimizer. For many NLP problems, the Adam optimizer is a good first choice. Adam is a variation of Stochastic Gradient Descent with several advantages: it maintains per-parameter learning rates and adapts these learning rates based on how quickly the values of a specific parameter are changing (or, how large its average gradient is).\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;Then the actual training starts. This happens in several epochs. During each epoch, we show all of the training data to the network, in the batches produced by the BucketIterators we created above. Before we show the model a new batch, we set the gradients of the model to zero to avoid accumulating gradients across batches. Then we let the model make its predictions for the batch. We do this by taking the output, and finding out what label received the highest score, using the `torch.max` method. We then compute the loss with respect to the correct labels. `loss.backward()` then computes the gradients for all model parameters; `optimizer.step()` performs an optimization step.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;When we have shown all the training data in an epoch, we perform the precision, recall and F-score on the training data and development data. Note that we compute the loss for the development data, but we do not optimize the model with it. Whenever the F-score on the development data is better than before, we save the model. If the F-score is lower than the minimum F-score we&#x27;ve seen in the past few epochs (we call this number the patience), we stop training.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">8</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;import torch.optim as optim\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;from tqdm import tqdm_notebook as tqdm\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;from sklearn.metrics import precision_recall_fscore_support, classification_report\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;def remove_predictions_for_masked_items(predicted_labels, correct_labels): \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    predicted_labels_without_mask = []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    correct_labels_without_mask = []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    for p, c in zip(predicted_labels, correct_labels):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        if c &gt; 1:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predicted_labels_without_mask.append(p)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            correct_labels_without_mask.append(c)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    return predicted_labels_without_mask, correct_labels_without_mask\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;def train(model, train_iter, dev_iter, batch_size, max_epochs, num_batches, patience, output_path):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    criterion = nn.CrossEntropyLoss(ignore_index=1)  # we mask the &lt;pad&gt; labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    optimizer = optim.Adam(model.parameters())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    train_f_score_history = []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    dev_f_score_history = []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    no_improvement = 0\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    for epoch in range(max_epochs):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        total_loss = 0\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        predictions, correct = [], []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        for batch in tqdm(train_iter, total=num_batches, desc=f\\&quot;Epoch {epoch}\\&quot;):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            optimizer.zero_grad()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            text_length, cur_batch_size = batch.text[0].shape\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            pred = model(batch.text[0].to(device), batch.text[1].to(device)).view(cur_batch_size*text_length, NUM_CLASSES)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            gold = batch.labels.to(device).view(cur_batch_size*text_length)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            loss = criterion(pred, gold)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            total_loss += loss.item()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            loss.backward()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            optimizer.step()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            _, pred_indices = torch.max(pred, 1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predicted_labels = list(pred_indices.cpu().numpy())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            correct_labels = list(batch.labels.view(cur_batch_size*text_length).numpy())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predicted_labels, correct_labels = remove_predictions_for_masked_items(predicted_labels, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                                                                                   correct_labels)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predictions += predicted_labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            correct += correct_labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        train_scores = precision_recall_fscore_support(correct, predictions, average=\\&quot;micro\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        train_f_score_history.append(train_scores[2])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        print(\\&quot;Total training loss:\\&quot;, total_loss)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        print(\\&quot;Training performance:\\&quot;, train_scores)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        total_loss = 0\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        predictions, correct = [], []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        for batch in dev_iter:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            text_length, cur_batch_size = batch.text[0].shape\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            pred = model(batch.text[0].to(device), batch.text[1].to(device)).view(cur_batch_size * text_length, NUM_CLASSES)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            gold = batch.labels.to(device).view(cur_batch_size * text_length)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            loss = criterion(pred, gold)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            total_loss += loss.item()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            _, pred_indices = torch.max(pred, 1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predicted_labels = list(pred_indices.cpu().numpy())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            correct_labels = list(batch.labels.view(cur_batch_size*text_length).numpy())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predicted_labels, correct_labels = remove_predictions_for_masked_items(predicted_labels, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                                                                                   correct_labels)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            predictions += predicted_labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            correct += correct_labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        dev_scores = precision_recall_fscore_support(correct, predictions, average=\\&quot;micro\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        print(\\&quot;Total development loss:\\&quot;, total_loss)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        print(\\&quot;Development performance:\\&quot;, dev_scores)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        dev_f = dev_scores[2]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        if len(dev_f_score_history) &gt; patience and dev_f &lt; max(dev_f_score_history):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            no_improvement += 1\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        elif len(dev_f_score_history) == 0 or dev_f &gt; max(dev_f_score_history):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            print(\\&quot;Saving model.\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            torch.save(model, output_path)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            no_improvement = 0\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        if no_improvement &gt; patience:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            print(\\&quot;Development F-score does not improve anymore. Stop training.\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            dev_f_score_history.append(dev_f)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            break\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;            \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        dev_f_score_history.append(dev_f)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    return train_f_score_history, dev_f_score_history&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;When we test the model, we basically take the same steps as in the evaluation on the development data above: we get the predictions, remove the masked items and print a classification report. &quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">9</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;def test(model, test_iter, batch_size, labels, target_names): \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    total_loss = 0\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    predictions, correct = [], []\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    for batch in test_iter:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        text_length, cur_batch_size = batch.text[0].shape\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        pred = model(batch.text[0].to(device), batch.text[1].to(device)).view(cur_batch_size * text_length, NUM_CLASSES)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        gold = batch.labels.to(device).view(cur_batch_size * text_length)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        _, pred_indices = torch.max(pred, 1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        predicted_labels = list(pred_indices.cpu().numpy())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        correct_labels = list(batch.labels.view(cur_batch_size*text_length).numpy())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        predicted_labels, correct_labels = remove_predictions_for_masked_items(predicted_labels, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                                                                               correct_labels)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        predictions += predicted_labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;        correct += correct_labels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;    print(classification_report(correct, predictions, labels=labels, target_names=target_names))&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Now we can start the actual training. We set the embedding dimension to 300 (the dimensionality of the FastText embeddings), and pick a hidden dimensionality for each component of the BiLSTM (which will therefore output 512-dimensional vectors). The number of classes (the length of the vocabulary of the label field) will become the dimensionality of the output layer. Finally, we also compute the number of batches in an epoch, so that we can show a progress bar.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">10</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ba140815a7334dd28cbf7296dc7cc749&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 0&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 222.35497660934925\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9244241132231894, 0.9244241132231894, 0.9244241132231894, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 24.117380052804947\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9296043728606681, 0.9296043728606681, 0.9296043728606681, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stderr&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;/opt/anaconda3/lib/python3.7/site-packages/torch/serialization.py:251: UserWarning: Couldn&#x27;t retrieve source code for container of type BiLSTMTagger. It won&#x27;t be checked for correctness upon loading.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;  \\&quot;type \\&quot; + obj.__name__ + \\&quot;. It won&#x27;t be checked \\&quot;\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;e1b4716ec9dd4d3dbe903309888ee6a5&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 1&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 71.356663974002\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9591253627050393, 0.9591253627050393, 0.9591253627050393, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 18.751499708741903\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9388913949107119, 0.9388913949107119, 0.9388913949107119, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;b88bc0032ec148ffb3e787d5b152b0eb&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 2&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 50.72972834017128\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9680819565346124, 0.9680819565346124, 0.9680819565346124, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 17.262520626187325\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9425531350333006, 0.9425531350333006, 0.9425531350333006, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;4f170531428d428688eeca047775ebf4&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 3&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 41.36486494448036\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9728291980024082, 0.9728291980024082, 0.9728291980024082, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 16.504801526665688\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9443309363971661, 0.9443309363971661, 0.9443309363971661, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;1b679486eaf3421bbf20686375c8c41b&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 4&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 35.585738136898726\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9755877302066679, 0.9755877302066679, 0.9755877302066679, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 16.711221787147224\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9458964629713164, 0.9458964629713164, 0.9458964629713164, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;041d9f3c52464656bae1af40ac9960b8&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 5&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 30.99800857482478\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9784597619470599, 0.9784597619470599, 0.9784597619470599, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 16.387646575458348\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9469578369198928, 0.9469578369198928, 0.9469578369198928, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;eb16a30222b04d49a285674d79abe5a0&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 6&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 27.11286850180477\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9801326464144016, 0.9801326464144016, 0.9801326464144016, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 17.557277165353298\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9460822034123172, 0.9460822034123172, 0.9460822034123172, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;b8bc31674a8c4d13bc3e54164f85c98e&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 7&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 24.422367892228067\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9820917471032945, 0.9820917471032945, 0.9820917471032945, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 16.09378209663555\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9491867222119033, 0.9491867222119033, 0.9491867222119033, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;5cc4cc80f7fd453ca8cdc695b90f37bd&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 8&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 22.412145966896787\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9829355914806261, 0.9829355914806261, 0.9829355914806261, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 19.413369961082935\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9440390585613077, 0.9440390585613077, 0.9440390585613077, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;16a0f3a493274d578645e7801e49ea6b&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 9&#x27;, max=494, style=ProgressStyle(description_width=&#x27;ini…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 20.09223960270174\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9845344545113598, 0.9845344545113598, 0.9845344545113598, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 15.523855119943619\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.948072279565898, 0.948072279565898, 0.948072279565898, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;9282699e0d6a41f6a5c479f3e4b324c8&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 10&#x27;, max=494, style=ProgressStyle(description_width=&#x27;in…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 17.925453061121516\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9860395570557233, 0.9860395570557233, 0.9860395570557233, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 16.789274506270885\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9485233634940431, 0.9485233634940431, 0.9485233634940432, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;0dd2a7a78ddb40c5b2bc4f5211866565&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 11&#x27;, max=494, style=ProgressStyle(description_width=&#x27;in…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 16.409397734270897\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9867205542725174, 0.9867205542725174, 0.9867205542725174, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 14.920704647898674\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.950195027463051, 0.950195027463051, 0.950195027463051, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Saving model.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;4f8b52d4449940b6bafb77e162872878&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 12&#x27;, max=494, style=ProgressStyle(description_width=&#x27;in…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 14.990085303143132\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9879493101202108, 0.9879493101202108, 0.9879493101202108, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 17.077377565205097\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.949876615278478, 0.949876615278478, 0.949876615278478, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;446456c24c1443809e9a472e93c8bc21&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 13&#x27;, max=494, style=ProgressStyle(description_width=&#x27;in…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 13.492025993036805\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9886845897238506, 0.9886845897238506, 0.9886845897238506, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 19.90118957636878\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9481253482633268, 0.9481253482633268, 0.9481253482633268, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;b37c259297374650955ab0b45cf71ed9&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 14&#x27;, max=494, style=ProgressStyle(description_width=&#x27;in…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 12.34741208187188\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9893507826533231, 0.9893507826533231, 0.9893507826533231, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 18.731272239238024\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.9497970122323347, 0.9497970122323347, 0.9497970122323347, None)\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;application/vnd.jupyter.widget-view+json&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n       <span class=\"hljs-attr\">&quot;model_id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;d2796b99700548169493af184b534c8b&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_major&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-attr\">&quot;version_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;HBox(children=(IntProgress(value=0, description=&#x27;Epoch 15&#x27;, max=494, style=ProgressStyle(description_width=&#x27;in…&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total training loss: 10.979540771790198\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Training performance: (0.9901650184560116, 0.9901650184560116, 0.9901650184560116, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Total development loss: 17.838901833223645\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development performance: (0.949558203093905, 0.949558203093905, 0.949558203093905, None)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;Development F-score does not improve anymore. Stop training.\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;import math\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;EMBEDDING_DIM = 300\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;HIDDEN_DIM = 256\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;NUM_CLASSES = len(label_field.vocab)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;MAX_EPOCHS = 50\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;PATIENCE = 3\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;OUTPUT_PATH = \\&quot;/tmp/bilstmtagger\\&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;num_batches = math.ceil(len(train_data) / BATCH_SIZE)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;tagger = BiLSTMTagger(EMBEDDING_DIM, HIDDEN_DIM, VOCAB_SIZE+2, NUM_CLASSES, embeddings=embedding_matrix)  \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;train_f, dev_f = train(tagger.to(device), train_iter, dev_iter, BATCH_SIZE, MAX_EPOCHS, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                       num_batches, PATIENCE, OUTPUT_PATH)&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Let&#x27;s now plot the evolution of the F-score on our training and development set, to visually evaluate if training went well. If it did, the training F-score should first increase suddenly, then more gradually. The development F-score will increase during the first few epochs, but at some point it will start to decrease again. That&#x27;s when the model starts overfitting. This is where we abandon training, and why we only save the model when we have reached an optimal F-score on the development data.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">11</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;image/png&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;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\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;&lt;Figure size 432x288 with 1 Axes&gt;&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;needs_background&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;light&quot;</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;%matplotlib notebook\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;%matplotlib inline\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;import matplotlib.pyplot as plt\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;import pandas as pd\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;# Data\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;df = pd.DataFrame({&#x27;epochs&#x27;: range(0,len(train_f)), \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                  &#x27;train_f&#x27;: train_f, \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;                   &#x27;dev_f&#x27;: dev_f})\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot; \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;# multiple line plot\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;plt.plot(&#x27;epochs&#x27;, &#x27;train_f&#x27;, data=df, color=&#x27;blue&#x27;, linewidth=2)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;plt.plot(&#x27;epochs&#x27;, &#x27;dev_f&#x27;, data=df, color=&#x27;green&#x27;, linewidth=2)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;plt.legend()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;plt.show()\\n&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Before we test our model on the test data, we have to run its `eval()` method. This will put the model in eval mode, and deactivate dropout layers and other functionality that is only useful in training.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">12</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n       <span class=\"hljs-string\">&quot;BiLSTMTagger(\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (embeddings): Embedding(20002, 300)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (lstm): LSTM(300, 256, bidirectional=True)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (dropout_layer): Dropout(p=0.5)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;  (hidden2tag): Linear(in_features=512, out_features=11, bias=True)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n       <span class=\"hljs-string\">&quot;)&quot;</span>\n      <span class=\"hljs-punctuation\">]</span>\n     <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">12</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;execute_result&quot;</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;tagger = torch.load(OUTPUT_PATH)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;tagger.eval()&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;Finally, we test the model. You&#x27;ll notice its performance is significantly lower than that of the CRF we explored in an earlier notebook. Designing a competitive neural network takes considerably more effort than we put in here: you&#x27;ll need to make the architecture of the network more complex, optimize its hyperparameters, and often also throw considerably more data at your model.&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">13</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n     <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n     <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n      <span class=\"hljs-string\">&quot;             precision    recall  f1-score   support\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;      B-LOC       0.83      0.67      0.75       774\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;      I-LOC       0.42      0.45      0.44        49\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;     B-MISC       0.83      0.48      0.60      1187\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;     I-MISC       0.58      0.25      0.35       410\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;      B-ORG       0.72      0.56      0.63       882\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;      I-ORG       0.74      0.57      0.64       551\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;      B-PER       0.82      0.68      0.74      1098\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;      I-PER       0.95      0.71      0.81       807\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;avg / total       0.80      0.58      0.67      5758\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-string\">&quot;\\n&quot;</span>\n     <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span>\n   <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;labels = label_field.vocab.itos[3:]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;labels = sorted(labels, key=lambda x: x.split(\\&quot;-\\&quot;)[-1])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;label_idxs = [label_field.vocab.stoi[l] for l in labels]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;test(tagger, test_iter, BATCH_SIZE, labels = label_idxs, target_names = labels)&quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;# Conclusion\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;In this notebook we&#x27;ve trained a simple bidirectional LSTM for named entity recognition. Far from achieving state-of-the-art performance, our aim was to understand how neural networks can be implemented and trained in PyTorch. To improve our performance, one of the things that is typically done is to add an additional CRF layer to the neural network. This layer helps us optimize the complete label sequence, and not the labels individually. We leave that for future work. &quot;</span>\n   <span class=\"hljs-punctuation\">]</span>\n  <span class=\"hljs-punctuation\">}</span>\n <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">&quot;kernelspec&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;display_name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Python 3&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;language&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python3&quot;</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;language_info&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n   <span class=\"hljs-attr\">&quot;codemirror_mode&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ipython&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">3</span>\n   <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;file_extension&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;.py&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;mimetype&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;text/x-python&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;nbconvert_exporter&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;pygments_lexer&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ipython3&quot;</span><span class=\"hljs-punctuation\">,</span>\n   <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;3.7.1&quot;</span>\n  <span class=\"hljs-punctuation\">}</span>\n <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n <span class=\"hljs-attr\">&quot;nbformat&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span>\n <span class=\"hljs-attr\">&quot;nbformat_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span>\n<span class=\"hljs-punctuation\">}</span>\n"
    }
  },
  "contributors": [
    {
      "name": "Krishna Pal Deora",
      "email": "47516664+krishnapalS@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}