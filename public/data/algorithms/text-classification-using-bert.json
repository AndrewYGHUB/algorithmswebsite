{
  "slug": "text-classification-using-bert",
  "name": "Text Classification Using BERT",
  "categories": [
    "neuralnetwork",
    "textclassification"
  ],
  "body": {
    "all": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><p>#Text Classification using BERT</p>\n<p>The is a basic implementation of text classification pipeline using BERT. The BERT model used has been taken from <a href=\"https://huggingface.co/transformers/\">huggingface</a>. The dataset used is a custom dataset with two classes (labelled as 0 and 1). It is publically available <a href=\"https://raw.githubusercontent.com/prateekjoshi565/Fine-Tuning-BERT/master/spamdata_v2.csv\">here</a>.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"1\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">!pip install transformers</code></pre></div><div class=\"nb-output\" data-prompt-number=\"1\"><pre class=\"nb-stdout\">Collecting transformers\n  Downloading transformers-<span class=\"hljs-number\">4.10</span>.<span class=\"hljs-number\">0</span>-py3-none-<span class=\"hljs-keyword\">any</span>.whl (<span class=\"hljs-number\">2.8</span> MB)\n     |████████████████████████████████| <span class=\"hljs-number\">2.8</span> MB <span class=\"hljs-number\">4.0</span> MB/s \nRequirement already satisfied: filelock in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">3.0</span>.<span class=\"hljs-number\">12</span>)\nCollecting huggingface-hub&amp;amp;gt;=<span class=\"hljs-number\">0.0</span>.<span class=\"hljs-number\">12</span>\n  Downloading huggingface_hub-<span class=\"hljs-number\">0.0</span>.<span class=\"hljs-number\">16</span>-py3-none-<span class=\"hljs-keyword\">any</span>.whl (<span class=\"hljs-number\">50</span> kB)\n     |████████████████████████████████| <span class=\"hljs-number\">50</span> kB <span class=\"hljs-number\">6.8</span> MB/s \nRequirement already satisfied: numpy&amp;amp;gt;=<span class=\"hljs-number\">1.17</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">1.19</span>.<span class=\"hljs-number\">5</span>)\nCollecting pyyaml&amp;amp;gt;=<span class=\"hljs-number\">5.1</span>\n  Downloading PyYAML-<span class=\"hljs-number\">5.4</span>.<span class=\"hljs-number\">1</span>-cp37-cp37m-manylinux1_x86_64.whl (<span class=\"hljs-number\">636</span> kB)\n     |████████████████████████████████| <span class=\"hljs-number\">636</span> kB <span class=\"hljs-number\">51.9</span> MB/s \nRequirement already satisfied: packaging in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">21.0</span>)\nCollecting tokenizers&amp;amp;lt;<span class=\"hljs-number\">0.11</span>,&amp;amp;gt;=<span class=\"hljs-number\">0.10</span>.<span class=\"hljs-number\">1</span>\n  Downloading tokenizers-<span class=\"hljs-number\">0.10</span>.<span class=\"hljs-number\">3</span>-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (<span class=\"hljs-number\">3.3</span> MB)\n     |████████████████████████████████| <span class=\"hljs-number\">3.3</span> MB <span class=\"hljs-number\">21.4</span> MB/s \nRequirement already satisfied: tqdm&amp;amp;gt;=<span class=\"hljs-number\">4.27</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">4.62</span>.<span class=\"hljs-number\">0</span>)\nRequirement already satisfied: regex!=<span class=\"hljs-number\">2019.12</span>.<span class=\"hljs-number\">17</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">2019.12</span>.<span class=\"hljs-number\">20</span>)\nRequirement already satisfied: requests in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">2.23</span>.<span class=\"hljs-number\">0</span>)\nCollecting sacremoses\n  Downloading sacremoses-<span class=\"hljs-number\">0.0</span>.<span class=\"hljs-number\">45</span>-py3-none-<span class=\"hljs-keyword\">any</span>.whl (<span class=\"hljs-number\">895</span> kB)\n     |████████████████████████████████| <span class=\"hljs-number\">895</span> kB <span class=\"hljs-number\">45.3</span> MB/s \nRequirement already satisfied: importlib-metadata in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> transformers) (<span class=\"hljs-number\">4.6</span>.<span class=\"hljs-number\">4</span>)\nRequirement already satisfied: typing-extensions in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> huggingface-hub&amp;amp;gt;=<span class=\"hljs-number\">0.0</span>.<span class=\"hljs-number\">12</span>-&amp;amp;gt;transformers) (<span class=\"hljs-number\">3.7</span>.<span class=\"hljs-number\">4.3</span>)\nRequirement already satisfied: pyparsing&amp;amp;gt;=<span class=\"hljs-number\">2.0</span>.<span class=\"hljs-number\">2</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> packaging-&amp;amp;gt;transformers) (<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">7</span>)\nRequirement already satisfied: zipp&amp;amp;gt;=<span class=\"hljs-number\">0.5</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> importlib-metadata-&amp;amp;gt;transformers) (<span class=\"hljs-number\">3.5</span>.<span class=\"hljs-number\">0</span>)\nRequirement already satisfied: chardet&amp;amp;lt;<span class=\"hljs-number\">4</span>,&amp;amp;gt;=<span class=\"hljs-number\">3.0</span>.<span class=\"hljs-number\">2</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> requests-&amp;amp;gt;transformers) (<span class=\"hljs-number\">3.0</span>.<span class=\"hljs-number\">4</span>)\nRequirement already satisfied: certifi&amp;amp;gt;=<span class=\"hljs-number\">2017.4</span>.<span class=\"hljs-number\">17</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> requests-&amp;amp;gt;transformers) (<span class=\"hljs-number\">2021.5</span>.<span class=\"hljs-number\">30</span>)\nRequirement already satisfied: urllib3!=<span class=\"hljs-number\">1.25</span>.<span class=\"hljs-number\">0</span>,!=<span class=\"hljs-number\">1.25</span>.<span class=\"hljs-number\">1</span>,&amp;amp;lt;<span class=\"hljs-number\">1.26</span>,&amp;amp;gt;=<span class=\"hljs-number\">1.21</span>.<span class=\"hljs-number\">1</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> requests-&amp;amp;gt;transformers) (<span class=\"hljs-number\">1.24</span>.<span class=\"hljs-number\">3</span>)\nRequirement already satisfied: idna&amp;amp;lt;<span class=\"hljs-number\">3</span>,&amp;amp;gt;=<span class=\"hljs-number\">2.5</span> in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> requests-&amp;amp;gt;transformers) (<span class=\"hljs-number\">2.10</span>)\nRequirement already satisfied: six in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> sacremoses-&amp;amp;gt;transformers) (<span class=\"hljs-number\">1.15</span>.<span class=\"hljs-number\">0</span>)\nRequirement already satisfied: click in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> sacremoses-&amp;amp;gt;transformers) (<span class=\"hljs-number\">7.1</span>.<span class=\"hljs-number\">2</span>)\nRequirement already satisfied: joblib in <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/lib/</span>python3.<span class=\"hljs-number\">7</span>/dist-packages (<span class=\"hljs-keyword\">from</span> sacremoses-&amp;amp;gt;transformers) (<span class=\"hljs-number\">1.0</span>.<span class=\"hljs-number\">1</span>)\nInstalling collected packages: tokenizers, sacremoses, pyyaml, huggingface-hub, transformers\n  Attempting uninstall: pyyaml\n    Found existing installation: PyYAML <span class=\"hljs-number\">3.13</span>\n    Uninstalling PyYAML-<span class=\"hljs-number\">3.13</span>:\n      Successfully uninstalled PyYAML-<span class=\"hljs-number\">3.13</span>\nSuccessfully installed huggingface-hub-<span class=\"hljs-number\">0.0</span>.<span class=\"hljs-number\">16</span> pyyaml-<span class=\"hljs-number\">5.4</span>.<span class=\"hljs-number\">1</span> sacremoses-<span class=\"hljs-number\">0.0</span>.<span class=\"hljs-number\">45</span> tokenizers-<span class=\"hljs-number\">0.10</span>.<span class=\"hljs-number\">3</span> transformers-<span class=\"hljs-number\">4.10</span>.<span class=\"hljs-number\">0</span>\n</pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"1\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> csv\n<span class=\"hljs-keyword\">import</span> pickle\n<span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\ntrain = pd.read_csv(<span class=\"hljs-string\">\"spamdata_v2.csv\"</span>)\n</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"2\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">len</span>(train))\ntrain.head()</code></pre></div><div class=\"nb-output\" data-prompt-number=\"2\"><pre class=\"nb-stdout\"><span class=\"hljs-number\">5572</span>\n</pre></div><div class=\"nb-output\" data-prompt-number=\"2\"><div class=\"nb-html-output\"><div>\n<style>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table class=\"dataframe\" border=\"1\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>label</th>\n      <th>text</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>Go until jurong point, crazy.. Available only ...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>Ok lar... Joking wif u oni...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1</td>\n      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0</td>\n      <td>U dun say so early hor... U c already then say...</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>Nah I don't think he goes to usf, he lives aro...</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"3\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">num_classes = <span class=\"hljs-number\">2</span></code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"4\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> sklearn.model_selection <span class=\"hljs-keyword\">import</span> train_test_split\ntrain_split, val_split = train_test_split(train, test_size=<span class=\"hljs-number\">.05</span>)</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"5\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> transformers <span class=\"hljs-keyword\">import</span> BertTokenizerFast\ntokenizer = BertTokenizerFast.from_pretrained(<span class=\"hljs-string\">'bert-base-uncased'</span>)</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"6\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> torch\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Dataset</span>(torch.utils.data.Dataset):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, df, tokenizer, max_length=<span class=\"hljs-number\">128</span></span>):\n        self.df = df\n        self.text = df.text.values\n        self.labels = df.label.values\n        self.tokenizer = tokenizer\n        self.max_length = max_length\n \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__getitem__</span>(<span class=\"hljs-params\">self, idx</span>):\n        \n        tokenized_data = tokenizer.tokenize(self.text[idx])\n        to_append = [<span class=\"hljs-string\">\"[CLS]\"</span>] + tokenized_data[:self.max_length - <span class=\"hljs-number\">2</span>] + [<span class=\"hljs-string\">\"[SEP]\"</span>]\n        input_ids = tokenizer.convert_tokens_to_ids(to_append)\n        input_mask = [<span class=\"hljs-number\">1</span>] * <span class=\"hljs-built_in\">len</span>(input_ids)\n        padding = [<span class=\"hljs-number\">0</span>] * (self.max_length - <span class=\"hljs-built_in\">len</span>(input_ids))\n        input_ids += padding\n        input_mask += padding\n        item = {\n            <span class=\"hljs-string\">\"input_ids\"</span>: torch.tensor(input_ids, dtype=torch.long),\n            <span class=\"hljs-string\">\"attention_mask\"</span>: torch.tensor(input_mask, dtype=torch.long)\n        }\n        item[<span class=\"hljs-string\">'labels'</span>] = torch.tensor(self.labels[idx], dtype=torch.long)\n        <span class=\"hljs-keyword\">return</span> item\n \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__len__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">len</span>(self.df)\n\ntrain_dataset = Dataset(train_split.fillna(<span class=\"hljs-string\">\"\"</span>), tokenizer)\nval_dataset = Dataset(val_split.fillna(<span class=\"hljs-string\">\"\"</span>), tokenizer)\n<span class=\"hljs-comment\"># train_dataset = Dataset(train.fillna(\"\"), tokenizer, is_train=True, label_map=label_map)</span>\n<span class=\"hljs-comment\"># test_dataset = Dataset(test.fillna(\"\"), tokenizer, is_train=False)</span></code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\" data-prompt-number=\"7\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> transformers <span class=\"hljs-keyword\">import</span> BertForSequenceClassification, Trainer, TrainingArguments\n\ntraining_args = TrainingArguments(\n    output_dir=<span class=\"hljs-string\">'./results'</span>,          <span class=\"hljs-comment\"># output directory</span>\n    num_train_epochs=<span class=\"hljs-number\">50</span>,              <span class=\"hljs-comment\"># total number of training epochs</span>\n    per_device_train_batch_size=<span class=\"hljs-number\">64</span>, <span class=\"hljs-comment\"># batch size per device during training</span>\n    per_device_eval_batch_size=<span class=\"hljs-number\">64</span>,  <span class=\"hljs-comment\"># batch size for evaluation</span>\n    warmup_steps=<span class=\"hljs-number\">500</span>,               <span class=\"hljs-comment\"># number of warmup steps for learning rate scheduler</span>\n    weight_decay=<span class=\"hljs-number\">0.01</span>,               <span class=\"hljs-comment\"># strength of weight decay</span>\n    logging_dir=<span class=\"hljs-string\">'./logs'</span>,            <span class=\"hljs-comment\"># directory for storing logs</span>\n    logging_steps=<span class=\"hljs-number\">100</span>,\n    dataloader_num_workers=<span class=\"hljs-number\">2</span>,\n    report_to=<span class=\"hljs-string\">\"tensorboard\"</span>,\n    label_smoothing_factor=<span class=\"hljs-number\">0.1</span>,\n    evaluation_strategy=<span class=\"hljs-string\">\"steps\"</span>,\n    eval_steps=<span class=\"hljs-number\">500</span>, <span class=\"hljs-comment\"># Evaluation and Save happens every 500 steps</span>\n    save_total_limit=<span class=\"hljs-number\">3</span>, <span class=\"hljs-comment\"># Only last 5 models are saved. Older ones are deleted.</span>\n    load_best_model_at_end=<span class=\"hljs-literal\">True</span>,   <span class=\"hljs-comment\">#best model is always saved</span>\n)\n\nmodel = BertForSequenceClassification.from_pretrained(<span class=\"hljs-string\">\"bert-base-uncased\"</span>)\nmodel.classifier = torch.nn.Linear(<span class=\"hljs-number\">768</span>, num_classes)\nmodel.num_labels = num_classes</code></pre></div><div class=\"nb-output\" data-prompt-number=\"7\"><pre class=\"nb-stderr\"><span class=\"hljs-keyword\">Some</span> weights <span class=\"hljs-keyword\">of</span> the model <span class=\"hljs-keyword\">checkpoint</span> at bert-base-uncased were <span class=\"hljs-keyword\">not</span> used <span class=\"hljs-keyword\">when</span> initializing BertForSequenceClassification: [&amp;#x27;cls.predictions.<span class=\"hljs-keyword\">transform</span>.dense.bias&amp;#x27;, &amp;#x27;cls.predictions.bias&amp;#x27;, &amp;#x27;cls.predictions.<span class=\"hljs-keyword\">transform</span>.LayerNorm.weight&amp;#x27;, &amp;#x27;cls.seq_relationship.weight&amp;#x27;, &amp;#x27;cls.predictions.<span class=\"hljs-keyword\">transform</span>.LayerNorm.bias&amp;#x27;, &amp;#x27;cls.seq_relationship.bias&amp;#x27;, &amp;#x27;cls.predictions.decoder.weight&amp;#x27;, &amp;#x27;cls.predictions.<span class=\"hljs-keyword\">transform</span>.dense.weight&amp;#x27;]\n- This <span class=\"hljs-keyword\">IS</span> expected <span class=\"hljs-keyword\">if</span> you are initializing BertForSequenceClassification <span class=\"hljs-keyword\">from</span> the <span class=\"hljs-keyword\">checkpoint</span> <span class=\"hljs-keyword\">of</span> a model trained <span class=\"hljs-keyword\">on</span> another task <span class=\"hljs-keyword\">or</span> <span class=\"hljs-keyword\">with</span> another architecture (e.g. initializing a BertForSequenceClassification model <span class=\"hljs-keyword\">from</span> a BertForPreTraining model).\n- This <span class=\"hljs-keyword\">IS</span> <span class=\"hljs-keyword\">NOT</span> expected <span class=\"hljs-keyword\">if</span> you are initializing BertForSequenceClassification <span class=\"hljs-keyword\">from</span> the <span class=\"hljs-keyword\">checkpoint</span> <span class=\"hljs-keyword\">of</span> a model that you expect <span class=\"hljs-keyword\">to</span> be exactly identical (initializing a BertForSequenceClassification model <span class=\"hljs-keyword\">from</span> a BertForSequenceClassification model).\n<span class=\"hljs-keyword\">Some</span> weights <span class=\"hljs-keyword\">of</span> BertForSequenceClassification were <span class=\"hljs-keyword\">not</span> initialized <span class=\"hljs-keyword\">from</span> the model <span class=\"hljs-keyword\">checkpoint</span> at bert-base-uncased <span class=\"hljs-keyword\">and</span> are newly initialized: [&amp;#x27;classifier.weight&amp;#x27;, &amp;#x27;classifier.bias&amp;#x27;]\nYou should probably TRAIN this model <span class=\"hljs-keyword\">on</span> a down-stream task <span class=\"hljs-keyword\">to</span> be able <span class=\"hljs-keyword\">to</span> use it <span class=\"hljs-keyword\">for</span> predictions <span class=\"hljs-keyword\">and</span> inference.\n</pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">trainer = Trainer(\n    model=model,                         <span class=\"hljs-comment\"># the instantiated 🤗 Transformers model to be trained</span>\n    args=training_args,                  <span class=\"hljs-comment\"># training arguments, defined above</span>\n    train_dataset=train_dataset,         <span class=\"hljs-comment\"># training dataset</span>\n    eval_dataset=val_dataset             <span class=\"hljs-comment\"># evaluation dataset</span>\n)\ntrainer.train()</code></pre></div><div class=\"nb-output\"><pre class=\"nb-stderr\">***** Running training *****\n  <span class=\"hljs-type\">Num</span> <span class=\"hljs-variable\">examples</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">5293</span>\n  <span class=\"hljs-type\">Num</span> <span class=\"hljs-variable\">Epochs</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">50</span>\n  Instantaneous batch size <span class=\"hljs-type\">per</span> <span class=\"hljs-variable\">device</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">64</span>\n  Total train batch <span class=\"hljs-title function_\">size</span> <span class=\"hljs-params\">(w. parallel, distributed &amp;amp; accumulation)</span> = <span class=\"hljs-number\">64</span>\n  Gradient <span class=\"hljs-type\">Accumulation</span> <span class=\"hljs-variable\">steps</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1</span>\n  Total <span class=\"hljs-type\">optimization</span> <span class=\"hljs-variable\">steps</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4150</span>\n</pre></div><div class=\"nb-output\"><div class=\"nb-html-output\">\n    <div>\n      \n      <progress style=\"width:300px; height:20px; vertical-align: middle;\" max=\"4150\" value=\"408\"></progress>\n      [ 408/4150 16:23 &lt; 2:31:08, 0.41 it/s, Epoch 4.90/50]\n    </div>\n    <table class=\"dataframe\" border=\"1\">\n  <thead>\n    <tr style=\"text-align: left;\">\n      <th>Step</th>\n      <th>Training Loss</th>\n      <th>Validation Loss</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table><p></p></div></div><div class=\"nb-output\"><div class=\"nb-html-output\">\n    <div>\n      \n      <progress style=\"width:300px; height:20px; vertical-align: middle;\" max=\"4150\" value=\"1507\"></progress>\n      [1507/4150 1:01:13 &lt; 1:47:31, 0.41 it/s, Epoch 18.14/50]\n    </div>\n    <table class=\"dataframe\" border=\"1\">\n  <thead>\n    <tr style=\"text-align: left;\">\n      <th>Step</th>\n      <th>Training Loss</th>\n      <th>Validation Loss</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>500</td>\n      <td>0.243900</td>\n      <td>0.221590</td>\n    </tr>\n    <tr>\n      <td>1000</td>\n      <td>0.200800</td>\n      <td>0.217612</td>\n    </tr>\n    <tr>\n      <td>1500</td>\n      <td>0.198900</td>\n      <td>0.218175</td>\n    </tr>\n  </tbody>\n</table><p></p></div></div><div class=\"nb-output\"><pre class=\"nb-stderr\">***** Running Evaluation *****\n  Num examples = <span class=\"hljs-number\">279</span>\n  Batch size = <span class=\"hljs-number\">64</span>\nSaving model <span class=\"hljs-keyword\">checkpoint</span> <span class=\"hljs-keyword\">to</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-500</span>\n<span class=\"hljs-keyword\">Configuration</span> saved <span class=\"hljs-keyword\">in</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-500</span>/config.json\nModel weights saved <span class=\"hljs-keyword\">in</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-500</span>/pytorch_model.bin\n***** Running Evaluation *****\n  Num examples = <span class=\"hljs-number\">279</span>\n  Batch size = <span class=\"hljs-number\">64</span>\nSaving model <span class=\"hljs-keyword\">checkpoint</span> <span class=\"hljs-keyword\">to</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-1000</span>\n<span class=\"hljs-keyword\">Configuration</span> saved <span class=\"hljs-keyword\">in</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-1000</span>/config.json\nModel weights saved <span class=\"hljs-keyword\">in</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-1000</span>/pytorch_model.bin\n***** Running Evaluation *****\n  Num examples = <span class=\"hljs-number\">279</span>\n  Batch size = <span class=\"hljs-number\">64</span>\nSaving model <span class=\"hljs-keyword\">checkpoint</span> <span class=\"hljs-keyword\">to</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-1500</span>\n<span class=\"hljs-keyword\">Configuration</span> saved <span class=\"hljs-keyword\">in</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-1500</span>/config.json\nModel weights saved <span class=\"hljs-keyword\">in</span> ./results/<span class=\"hljs-keyword\">checkpoint</span><span class=\"hljs-number\">-1500</span>/pytorch_model.bin\n</pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"></code></pre></div></div></div></div>"
  },
  "implementations": {
    "jupyter": {
      "dir": "neural_network/Text Classification/text_classification_using_BERT.ipynb",
      "url": "https://github.com/TheAlgorithms/jupyter/tree/master/neural_network/Text Classification/text_classification_using_BERT.ipynb",
      "code": "<span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">&quot;nbformat&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;nbformat_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">5</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">&quot;kernelspec&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;display_name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Python 3&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;language&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python3&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;language_info&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;codemirror_mode&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ipython&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">3</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;file_extension&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;.py&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;mimetype&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;text/x-python&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;nbconvert_exporter&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;pygments_lexer&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ipython3&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;3.7.10&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;default_parameters&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">21629.871921</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-08-01T03:02:57.256605&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;environment_variables&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;input_path&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;__notebook__.ipynb&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;output_path&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;__notebook__.ipynb&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;parameters&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:27.384684&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2.3.3&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;colab&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;text classification using BERT.ipynb&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;provenance&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;accelerator&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;GPU&quot;</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;cells&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Lk52n6Tt0uJO&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;#Text Classification using BERT\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;The is a basic implementation of text classification pipeline using BERT. The BERT model used has been taken from [huggingface](https://huggingface.co/transformers/). The dataset used is a custom dataset with two classes (labelled as 0 and 1). It is publically available [here](https://raw.githubusercontent.com/prateekjoshi565/Fine-Tuning-BERT/master/spamdata_v2.csv).&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Lk52n6Tt0uJO&quot;</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:35.719217Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:35.717605Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:35.722099Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:35.722966Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:17:49.337897Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0.024617</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:35.723409&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:02:35.698792&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;colab&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;base_uri&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;https://localhost:8080/&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;788d3220&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;outputId&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;54b8c951-4479-4581-9f17-d3f7e23bd477&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;!pip install transformers&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;788d3220&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n            <span class=\"hljs-string\">&quot;Collecting transformers\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Downloading transformers-4.10.0-py3-none-any.whl (2.8 MB)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[K     |████████████████████████████████| 2.8 MB 4.0 MB/s \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.0.12)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Collecting huggingface-hub&gt;=0.0.12\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Downloading huggingface_hub-0.0.16-py3-none-any.whl (50 kB)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[K     |████████████████████████████████| 50 kB 6.8 MB/s \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[?25hRequirement already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.19.5)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Collecting pyyaml&gt;=5.1\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Downloading PyYAML-5.4.1-cp37-cp37m-manylinux1_x86_64.whl (636 kB)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[K     |████████████████████████████████| 636 kB 51.9 MB/s \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers) (21.0)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Collecting tokenizers&lt;0.11,&gt;=0.10.1\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[K     |████████████████████████████████| 3.3 MB 21.4 MB/s \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[?25hRequirement already satisfied: tqdm&gt;=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.62.0)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Collecting sacremoses\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Downloading sacremoses-0.0.45-py3-none-any.whl (895 kB)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[K     |████████████████████████████████| 895 kB 45.3 MB/s \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;\\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.6.4)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from huggingface-hub&gt;=0.0.12-&gt;transformers) (3.7.4.3)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: pyparsing&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging-&gt;transformers) (2.4.7)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata-&gt;transformers) (3.5.0)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;transformers) (3.0.4)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;transformers) (2021.5.30)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;transformers) (1.24.3)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;transformers) (2.10)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses-&gt;transformers) (1.15.0)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses-&gt;transformers) (7.1.2)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses-&gt;transformers) (1.0.1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Installing collected packages: tokenizers, sacremoses, pyyaml, huggingface-hub, transformers\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Attempting uninstall: pyyaml\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;    Found existing installation: PyYAML 3.13\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;    Uninstalling PyYAML-3.13:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;      Successfully uninstalled PyYAML-3.13\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Successfully installed huggingface-hub-0.0.16 pyyaml-5.4.1 sacremoses-0.0.45 tokenizers-0.10.3 transformers-4.10.0\\n&quot;</span>\n          <span class=\"hljs-punctuation\">]</span>\n        <span class=\"hljs-punctuation\">}</span>\n      <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:05:44.436123Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:05:44.435351Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:30.493736Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:30.492714Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:21:08.023057Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">46.206213</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:30.494123&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:05:44.287910&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;c90ffee0&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;import csv\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;import pickle\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;import pandas as pd\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;import numpy as np\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;train = pd.read_csv(\\&quot;spamdata_v2.csv\\&quot;)\\n&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;c90ffee0&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:30.792497Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:30.791325Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:31.512114Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:31.512646Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:21:53.599755Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0.877222</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:31.512821&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:30.635599&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;colab&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;base_uri&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;https://localhost:8080/&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;height&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">219</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;fdb5210b&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;outputId&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;421a3979-dfdd-4a0f-d331-4b328ba545f3&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;print(len(train))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;train.head()&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;fdb5210b&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stdout&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n            <span class=\"hljs-string\">&quot;5572\\n&quot;</span>\n          <span class=\"hljs-punctuation\">]</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;execute_result&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n            <span class=\"hljs-attr\">&quot;text/html&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n              <span class=\"hljs-string\">&quot;&lt;div&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;style scoped&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    .dataframe tbody tr th:only-of-type {\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;        vertical-align: middle;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    }\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    .dataframe tbody tr th {\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;        vertical-align: top;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    }\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    .dataframe thead th {\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;        text-align: right;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    }\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;/style&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;table border=\\&quot;1\\&quot; class=\\&quot;dataframe\\&quot;&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;thead&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr style=\\&quot;text-align: right;\\&quot;&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;label&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;text&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;/thead&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;tbody&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;0&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;Go until jurong point, crazy.. Available only ...&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;1&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;Ok lar... Joking wif u oni...&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;2&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;1&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;Free entry in 2 a wkly comp to win FA Cup fina...&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;3&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;U dun say so early hor... U c already then say...&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;4&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;Nah I don&#x27;t think he goes to usf, he lives aro...&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;/tbody&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;/table&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;/div&gt;&quot;</span>\n            <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n              <span class=\"hljs-string\">&quot;   label                                               text\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;0      0  Go until jurong point, crazy.. Available only ...\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;1      0                      Ok lar... Joking wif u oni...\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;2      1  Free entry in 2 a wkly comp to win FA Cup fina...\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;3      0  U dun say so early hor... U c already then say...\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;4      0  Nah I don&#x27;t think he goes to usf, he lives aro...&quot;</span>\n            <span class=\"hljs-punctuation\">]</span>\n          <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span>\n        <span class=\"hljs-punctuation\">}</span>\n      <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;mxdJUOsolsMj&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;num_classes = 2&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;mxdJUOsolsMj&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">3</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:31.796699Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:31.795920Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:39.859089Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:39.859561Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:21:54.413397Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">8.208197</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:39.859775&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:31.651578&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;eb38df80&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;from sklearn.model_selection import train_test_split\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;train_split, val_split = train_test_split(train, test_size=.05)&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;eb38df80&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.148699Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.147996Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.188820Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.188250Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:22:01.764055Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">0.187948</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.188979&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.001031&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;a9bbf53d&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;from transformers import BertTokenizerFast\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;tokenizer = BertTokenizerFast.from_pretrained(&#x27;bert-base-uncased&#x27;)&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;a9bbf53d&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">5</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.486360Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.485678Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:51.481509Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:51.480780Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:22:01.807511Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">11.150744</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:51.481655&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:40.330911&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;f91e37b7&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;import torch\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;class Dataset(torch.utils.data.Dataset):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    def __init__(self, df, tokenizer, max_length=128):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        self.df = df\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        self.text = df.text.values\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        self.labels = df.label.values\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        self.tokenizer = tokenizer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        self.max_length = max_length\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot; \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    def __getitem__(self, idx):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        tokenized_data = tokenizer.tokenize(self.text[idx])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        to_append = [\\&quot;[CLS]\\&quot;] + tokenized_data[:self.max_length - 2] + [\\&quot;[SEP]\\&quot;]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        input_ids = tokenizer.convert_tokens_to_ids(to_append)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        input_mask = [1] * len(input_ids)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        padding = [0] * (self.max_length - len(input_ids))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        input_ids += padding\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        input_mask += padding\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        item = {\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;            \\&quot;input_ids\\&quot;: torch.tensor(input_ids, dtype=torch.long),\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;            \\&quot;attention_mask\\&quot;: torch.tensor(input_mask, dtype=torch.long)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        }\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        item[&#x27;labels&#x27;] = torch.tensor(self.labels[idx], dtype=torch.long)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        return item\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot; \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    def __len__(self):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;        return len(self.df)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;train_dataset = Dataset(train_split.fillna(\\&quot;\\&quot;), tokenizer)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;val_dataset = Dataset(val_split.fillna(\\&quot;\\&quot;), tokenizer)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;# train_dataset = Dataset(train.fillna(\\&quot;\\&quot;), tokenizer, is_train=True, label_map=label_map)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;# test_dataset = Dataset(test.fillna(\\&quot;\\&quot;), tokenizer, is_train=False)&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;f91e37b7&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">6</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:51.772366Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:51.771623Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:07:23.576720Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:07:23.576103Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply.started&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T08:22:12.696992Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">31.953274</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:07:23.576885&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:06:51.623611&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;colab&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;base_uri&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;https://localhost:8080/&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;6186779d&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;outputId&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;9e0874d1-9977-4b48-9c98-3d19e5d4ccd0&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;from transformers import BertForSequenceClassification, Trainer, TrainingArguments\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;training_args = TrainingArguments(\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    output_dir=&#x27;./results&#x27;,          # output directory\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    num_train_epochs=50,              # total number of training epochs\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    per_device_train_batch_size=64, # batch size per device during training\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    per_device_eval_batch_size=64,  # batch size for evaluation\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    warmup_steps=500,               # number of warmup steps for learning rate scheduler\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    weight_decay=0.01,               # strength of weight decay\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    logging_dir=&#x27;./logs&#x27;,            # directory for storing logs\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    logging_steps=100,\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    dataloader_num_workers=2,\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    report_to=\\&quot;tensorboard\\&quot;,\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    label_smoothing_factor=0.1,\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    evaluation_strategy=\\&quot;steps\\&quot;,\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    eval_steps=500, # Evaluation and Save happens every 500 steps\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    save_total_limit=3, # Only last 5 models are saved. Older ones are deleted.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    load_best_model_at_end=True,   #best model is always saved\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;model = BertForSequenceClassification.from_pretrained(\\&quot;bert-base-uncased\\&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;model.classifier = torch.nn.Linear(768, num_classes)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;model.num_labels = num_classes&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;6186779d&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">7</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stderr&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n            <span class=\"hljs-string\">&quot;Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertForSequenceClassification: [&#x27;cls.predictions.transform.dense.bias&#x27;, &#x27;cls.predictions.bias&#x27;, &#x27;cls.predictions.transform.LayerNorm.weight&#x27;, &#x27;cls.seq_relationship.weight&#x27;, &#x27;cls.predictions.transform.LayerNorm.bias&#x27;, &#x27;cls.seq_relationship.bias&#x27;, &#x27;cls.predictions.decoder.weight&#x27;, &#x27;cls.predictions.transform.dense.weight&#x27;]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: [&#x27;classifier.weight&#x27;, &#x27;classifier.bias&#x27;]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\\n&quot;</span>\n          <span class=\"hljs-punctuation\">]</span>\n        <span class=\"hljs-punctuation\">}</span>\n      <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;execution&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;iopub.execute_input&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:07:23.873644Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.busy&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:07:23.872942Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;iopub.status.idle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-08-01T03:02:53.329971Z&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;shell.execute_reply&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-08-01T03:02:53.330600Z&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;papermill&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;duration&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">21329.605812</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;end_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-08-01T03:02:53.332339&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;exception&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">false</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;start_time&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;2021-07-31T21:07:23.726527&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;status&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;completed&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;colab&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;base_uri&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;https://localhost:8080/&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;height&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">675</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;13abf542&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">&quot;outputId&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;42a52c37-29f9-4f43-a70f-c285886f0c10&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;trainer = Trainer(\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    model=model,                         # the instantiated 🤗 Transformers model to be trained\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    args=training_args,                  # training arguments, defined above\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    train_dataset=train_dataset,         # training dataset\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;    eval_dataset=val_dataset             # evaluation dataset\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-string\">&quot;trainer.train()&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;13abf542&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n            <span class=\"hljs-attr\">&quot;tags&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span>\n          <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stderr&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n            <span class=\"hljs-string\">&quot;***** Running training *****\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Num examples = 5293\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Num Epochs = 50\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Instantaneous batch size per device = 64\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Total train batch size (w. parallel, distributed &amp; accumulation) = 64\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Gradient Accumulation steps = 1\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Total optimization steps = 4150\\n&quot;</span>\n          <span class=\"hljs-punctuation\">]</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n            <span class=\"hljs-attr\">&quot;text/html&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n              <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;div&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;progress value=&#x27;408&#x27; max=&#x27;4150&#x27; style=&#x27;width:300px; height:20px; vertical-align: middle;&#x27;&gt;&lt;/progress&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      [ 408/4150 16:23 &lt; 2:31:08, 0.41 it/s, Epoch 4.90/50]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/div&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;table border=\\&quot;1\\&quot; class=\\&quot;dataframe\\&quot;&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;thead&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr style=\\&quot;text-align: left;\\&quot;&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;Step&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;Training Loss&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;Validation Loss&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;/thead&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;tbody&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;/tbody&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;/table&gt;&lt;p&gt;&quot;</span>\n            <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n              <span class=\"hljs-string\">&quot;&lt;IPython.core.display.HTML object&gt;&quot;</span>\n            <span class=\"hljs-punctuation\">]</span>\n          <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;display_data&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;data&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n            <span class=\"hljs-attr\">&quot;text/html&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n              <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;div&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;progress value=&#x27;1507&#x27; max=&#x27;4150&#x27; style=&#x27;width:300px; height:20px; vertical-align: middle;&#x27;&gt;&lt;/progress&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      [1507/4150 1:01:13 &lt; 1:47:31, 0.41 it/s, Epoch 18.14/50]\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/div&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;table border=\\&quot;1\\&quot; class=\\&quot;dataframe\\&quot;&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;thead&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr style=\\&quot;text-align: left;\\&quot;&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;Step&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;Training Loss&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;th&gt;Validation Loss&lt;/th&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;/thead&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;tbody&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;500&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0.243900&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0.221590&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;1000&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0.200800&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0.217612&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;1500&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0.198900&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;      &lt;td&gt;0.218175&lt;/td&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;    &lt;/tr&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;  &lt;/tbody&gt;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n              <span class=\"hljs-string\">&quot;&lt;/table&gt;&lt;p&gt;&quot;</span>\n            <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-attr\">&quot;text/plain&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n              <span class=\"hljs-string\">&quot;&lt;IPython.core.display.HTML object&gt;&quot;</span>\n            <span class=\"hljs-punctuation\">]</span>\n          <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span>\n        <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-punctuation\">{</span>\n          <span class=\"hljs-attr\">&quot;output_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stream&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;stderr&quot;</span><span class=\"hljs-punctuation\">,</span>\n          <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n            <span class=\"hljs-string\">&quot;***** Running Evaluation *****\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Num examples = 279\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Batch size = 64\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Saving model checkpoint to ./results/checkpoint-500\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Configuration saved in ./results/checkpoint-500/config.json\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Model weights saved in ./results/checkpoint-500/pytorch_model.bin\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;***** Running Evaluation *****\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Num examples = 279\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Batch size = 64\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Saving model checkpoint to ./results/checkpoint-1000\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Configuration saved in ./results/checkpoint-1000/config.json\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Model weights saved in ./results/checkpoint-1000/pytorch_model.bin\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;***** Running Evaluation *****\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Num examples = 279\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;  Batch size = 64\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Saving model checkpoint to ./results/checkpoint-1500\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Configuration saved in ./results/checkpoint-1500/config.json\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\n            <span class=\"hljs-string\">&quot;Model weights saved in ./results/checkpoint-1500/pytorch_model.bin\\n&quot;</span>\n          <span class=\"hljs-punctuation\">]</span>\n        <span class=\"hljs-punctuation\">}</span>\n      <span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-punctuation\">{</span>\n      <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;lsoxR09ymdHv&quot;</span>\n      <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n        <span class=\"hljs-string\">&quot;&quot;</span>\n      <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;id&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;lsoxR09ymdHv&quot;</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\n      <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span>\n    <span class=\"hljs-punctuation\">}</span>\n  <span class=\"hljs-punctuation\">]</span>\n<span class=\"hljs-punctuation\">}</span>"
    }
  },
  "contributors": [
    {
      "name": "TheConfused1",
      "email": "deepanshup003@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}